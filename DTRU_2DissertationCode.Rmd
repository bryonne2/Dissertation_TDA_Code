---
title: "HTRU_2DissertationCode"
author: "Brian Joseph"
date: "2024-12-31"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Intall_and_load_necessary_packages}

#install.packages('TDAmapper')
library(TDAmapper)
library(cluster)
library(vip)
#install.packages('kernlab’)
library(kernlab)
#install.packages(‘class’)
library(class)
#install.packages('nnet')
library(nnet)
#install.packages(‘randomForest’)
library(randomForest)
#install.packages('e1071')
library(e1071)                                                  
#install.packages("BayesFactor")
library(BayesFactor)
library(BayesPPD)
library(bayestestR)
#install.packages('igraph')
library('igraph')
#install.packages('locfit')
library(locfit)
#install.packages('ggplot2’)
library(ggplot2)
library(dplyr)
#install.packages('networkD3')
library(networkD3)
library(rstanarm)
library(see)
#install.packages('tidyverse')
library(tidyverse)
#install.packages('caret')
library(caret)
#install.packages('ISLR')
library(ISLR)
#install.packages('MCMCpack')
library(MCMCpack)
#linstall.packages("caret")
library(caret)
library(TDA)
library(TDAstats)
library(ks)
#install.packages('MLmetrics')
library(MLmetrics)
#install.packages('googledrive')
library(googledrive)
#install.packages('stringr')
library(stringr)
#install.packages('ks')
library(ks)
library(GGally)

```

```{r importDatasetsFromFilesOnHardDrive}
#HTRU_2library(readr)
HTRU_2 <- read.csv("~/Downloads/htru2/HTRU_2.csv", header=FALSE)
head(str(HTRU_2))
summary(HTRU_2)

#plot 1 of dataset
featurePlot(x = HTRU_2[,1:8], 
            y = as.factor(HTRU_2$V9), 
            plot = "box",
            strip=strip.custom(par.strip.text=list(cex=.7)),
            scales = list(x = list(relation="free"), 
                          y = list(relation="free")))
#Plot2 of dataset
ggpairs(HTRU_2)

```

```{r AddBayesianTestFuntions}

##Add Bayesian tests functions

#create function to conduct the Bayesian Sign Test
BayesianSignTest <- function(diffVector,rope_min,rope_max) {

  library(MCMCpack)

  samples <- 3000

  #build the vector 0.5 1 1 ....... 1 

  weights <- c(0.5,rep(1,length(diffVector)))

  #add the fake first observation in 0

  diffVector <- c (0, diffVector)  


  #for the moment we implement the sign test. Signedrank will follows

  probLeft <- mean (diffVector < rope_min)

  probRope <- mean (diffVector > rope_min & diffVector < rope_max)

  probRight <- mean (diffVector > rope_max)

  results = list ("probLeft"=probLeft, "probRope"=probRope,
                  
                  "probRight"=probRight)
  
  return (results)
}


##Create function to conduct Bayesian Signed Rank Test

BayesianSignedRank <- function(diffVector,rope_min,rope_max) {
  
  library(MCMCpack)
  
  samples <- 30000
  
  #build the vector 0.5 1 1 ....... 1
  weights <- c(0.5,rep(1,length(diffVector)))
  
  #add the fake first observation in 0
  diffVector <- c (0, diffVector)
  
  sampledWeights <- rdirichlet(samples,weights)
  
  winLeft <- vector(length = samples)
  winRope <- vector(length = samples)
  winRight <- vector(length = samples)
  
  for (rep in 1:samples){
    currentWeights <- sampledWeights[rep,]
    for (i in 1:length(currentWeights)){
      for (j in 1:length(currentWeights)){
        product= currentWeights[i] * currentWeights[j]
        if (diffVector[i]+diffVector[j] > (2*rope_max) ) {
          winRight[rep] <- winRight[rep] + product
        }
        else if (diffVector[i]+diffVector[j] > (2*rope_min) ) {
          winRope[rep] <- winRope[rep] + product
        }
        else {
          winLeft[rep] <- winLeft[rep] + product
        }

      }
    }
    maxWins=max(winRight[rep],winRope[rep],winLeft[rep])
    winners = (winRight[rep]==maxWins)*1 + (winRope[rep]==maxWins)*1 + (winLeft[rep]==maxWins)*1
    winRight[rep] <- (winRight[rep]==maxWins)*1/winners
    winRope[rep] <- (winRope[rep]==maxWins)*1/winners
    winLeft[rep] <- (winLeft[rep]==maxWins)*1/winners
  }
  
  
  results = list ("winLeft"=mean(winLeft), "winRope"=mean(winRope),
                  "winRight"=mean(winRight) )
  return (results)
  
}


#Create function to conduct the Bayesian Correlated t.test

#diff_a_b is a vector of differences between the two classifiers, on each fold of cross-validation.
#If you have done 10 runs of 10-folds cross-validation, you have 100 results for each classifier.
#You should have run cross-validation on the same folds for the two classifiers.
#Then diff_a_b is the difference fold-by-fold.

#rho is the correlation of the cross-validation results: 1/(number of folds)
#rope_min and rope_max are the lower and the upper bound of the rope
 
correlatedBayesianTtest <- function(diff_a_b,rho,rope_min,rope_max){
   if (rope_max < rope_min){
     stop("rope_max should be larger than rope_min")
   }
     
  delta <- mean(diff_a_b)
  n <- length(diff_a_b)
  df <- n-1
  stdX <- sd(diff_a_b)
  sp <- sd(diff_a_b)*sqrt(1/n + rho/(1-rho))
  p.left <- pt((rope_min - delta)/sp, df)
  p.rope <- pt((rope_max - delta)/sp, df)-p.left
  results <- list('left'=p.left,'rope'=p.rope,'right'=1-p.left-p.rope)
  return (results)
}

```

```{r Set_Seed_for_reproducible_results}

set.seed(16974)

```

```{r Onehot_encoding_if_necessary_for_Persistent_Homology, cache=TRUE}


##One hot encoding for HTRU_2 dataset
  library(caret)
  
  #define one-hot encoding function
  dummy_HTRU_2<- dummyVars(" ~ .", data=HTRU_2)
  
  #perform one-hot encoding on data frame
  HTRU_2.one_hot_df <- data.frame(predict(dummy_HTRU_2, newdata=HTRU_2))
  
  #str final data frame
  head(str(HTRU_2.one_hot_df))
  
  ##Persistent Homology of HTRU_2 dataset
  
  # calculate persistent homology for HTRU_2 Dataset
  #phom_HTRU_2_data_df <- calculate_homology(HTRU_2)
  
  # plot barcode for HTRU_2 Dataset
  #plot_barcode(phom_HTRU_2_data_df)
  
  # plot persistent diagram of HTRU_2 Dataset
  #plot_persist(phom_HTRU_2_data_df)

```

```{r Mapper Algorithm on Datasets, cache=TRUE}

#####———————————————MAPPER ALGORITHM————————————————

#Prepare HTRU_2 dataset for Mapper 1D algorithm

##Two Filter Functions PCA & KDE

#Prepare linear PCA as a filter function by centering and scaling dataset first on all one hot df dataset
b_htru_2<- prcomp(HTRU_2, center=TRUE, scale=TRUE)
ts_pca_b_htru_2 <- as.data.frame(predict(b_htru_2, HTRU_2))

#Conduct kernel density estimator as a filter function on 4 of 8
filter.kde.htru_2<- kde(HTRU_2[,1:4],H=diag(1,nrow = 4),eval.points =HTRU_2[,1:4])$estimate


###*** HTRU_2 PCA  Mapper 5 intervals, 60% overlap, 5 bins
##*** HTRU_2 PCA Mapper 5 intervals, 60% overlap, 5 bins

m_HTRU_2_5.60.5 <- mapper1D(
     distance_matrix = dist(HTRU_2),
     filter_values = c(ts_pca_b_htru_2$PC1),
     num_intervals =        5,
     percent_overlap = 60,
     num_bins_when_clustering = 5)
  

g_HTRU_2_5.60.5 <- graph.adjacency(m_HTRU_2_5.60.5$adjacency, mode="undirected")
plot(g_HTRU_2_5.60.5, layout = layout.auto(g_HTRU_2_5.60.5))


head(str(m_HTRU_2_5.60.5$level_of_vertex))

head(str(m_HTRU_2_5.60.5$vertices_in_level))

head(str(m_HTRU_2_5.60.5$points_in_vertex))



my_resolution = 100
my_palette = colorRampPalette(c('red','green','lightblue'))
my_max = max(m_HTRU_2_5.60.5$level_of_vertex, na.rm=TRUE)
my_vector = m_HTRU_2_5.60.5$level_of_vertex / my_max

my_colors = my_palette(my_resolution)[as.numeric(cut(
                       my_vector, breaks=my_resolution))]

g_HTRU_2_5.60.5 <- graph.adjacency(m_HTRU_2_5.60.5$adjacency, mode="undirected")
vertex_size <- unlist(lapply(m_HTRU_2_5.60.5$points_in_vertex,
                             function(x) length(x)))

plot(g_HTRU_2_5.60.5, layout = layout.auto(g_HTRU_2_5.60.5),
     vertex.size = 30*log(vertex_size)/
     max(log(vertex_size)),
     vertex.color = my_colors)


m_HTRU_2_5.60.5.n1<-m_HTRU_2_5.60.5$points_in_vertex[1]
	m_HTRU_2_5.60.5.n1.vec<-as.vector(unlist(m_HTRU_2_5.60.5.n1))
m_HTRU_2_5.60.5.n2<-m_HTRU_2_5.60.5$points_in_vertex[2]
	m_HTRU_2_5.60.5.n2.vec<-as.vector(unlist(m_HTRU_2_5.60.5.n2)) 
m_HTRU_2_5.60.5.n3<-m_HTRU_2_5.60.5$points_in_vertex[3]
	m_HTRU_2_5.60.5.n3.vec<-as.vector(unlist(m_HTRU_2_5.60.5.n3))
m_HTRU_2_5.60.5.n4<-m_HTRU_2_5.60.5$points_in_vertex[4]
	m_HTRU_2_5.60.5.n4.vec<-as.vector(unlist(m_HTRU_2_5.60.5.n4)) 
m_HTRU_2_5.60.5.n5<-m_HTRU_2_5.60.5$points_in_vertex[5]
	m_HTRU_2_5.60.5.n5.vec<-as.vector(unlist(m_HTRU_2_5.60.5.n5))

##map the ID’s of each Mapper vertex point to the actual HTRU_2 One Hot DF1 dataset
tda.m_HTRU_2_5.60.5.n1.vec<-HTRU_2[m_HTRU_2_5.60.5.n1.vec,]
tda.m_HTRU_2_5.60.5.n2.vec<-HTRU_2[m_HTRU_2_5.60.5.n2.vec,]
tda.m_HTRU_2_5.60.5.n3.vec<-HTRU_2[m_HTRU_2_5.60.5.n3.vec,]
tda.m_HTRU_2_5.60.5.n4.vec<-HTRU_2[m_HTRU_2_5.60.5.n4.vec,]
tda.m_HTRU_2_5.60.5.n5.vec<-HTRU_2[m_HTRU_2_5.60.5.n5.vec,]


###*** HTRU_2 Mapper 5 intervals, 50% overlap, 5 bins

m_HTRU_2_5.50.5 <- mapper1D(
     distance_matrix = dist(HTRU_2),
     filter_values = c(ts_pca_b_htru_2$PC1),
     num_intervals = 5,
     percent_overlap = 50,
     num_bins_when_clustering = 5)


g_HTRU_2_5.50.5 <- graph.adjacency(m_HTRU_2_5.50.5$adjacency, mode="undirected")
plot(g_HTRU_2_5.50.5, layout = layout.auto(g_HTRU_2_5.50.5))


head(str(m_HTRU_2_5.50.5$level_of_vertex))

head(str(m_HTRU_2_5.50.5$vertices_in_level))

head(str(m_HTRU_2_5.50.5$points_in_vertex))



my_resolution = 100
my_palette = colorRampPalette(c('red','green','lightblue'))
my_max = max(m_HTRU_2_5.50.5$level_of_vertex, na.rm=TRUE)
my_vector = m_HTRU_2_5.50.5$level_of_vertex / my_max

my_colors = my_palette(my_resolution)[as.numeric(cut(
                       my_vector, breaks=my_resolution))]

g_HTRU_2_5.50.5 <- graph.adjacency(m_HTRU_2_5.50.5$adjacency, mode="undirected")
vertex_size <- unlist(lapply(m_HTRU_2_5.50.5$points_in_vertex,
                             function(x) length(x)))

plot(g_HTRU_2_5.50.5, layout = layout.auto(g_HTRU_2_5.50.5),
     vertex.size = 30*log(vertex_size)/
     max(log(vertex_size)),
     vertex.color = my_colors)

##Extract the ID observations of each mapper output vertex
m_HTRU_2_5.50.5.n1<-m_HTRU_2_5.50.5$points_in_vertex[1]
	m_HTRU_2_5.50.5.n1.vec<-as.vector(unlist(m_HTRU_2_5.50.5.n1))
m_HTRU_2_5.50.5.n2<-m_HTRU_2_5.50.5$points_in_vertex[2]
	m_HTRU_2_5.50.5.n2.vec<-as.vector(unlist(m_HTRU_2_5.50.5.n2)) 
m_HTRU_2_5.50.5.n3<-m_HTRU_2_5.50.5$points_in_vertex[3]
	m_HTRU_2_5.50.5.n3.vec<-as.vector(unlist(m_HTRU_2_5.50.5.n3))
m_HTRU_2_5.50.5.n4<-m_HTRU_2_5.50.5$points_in_vertex[4]
	m_HTRU_2_5.50.5.n4.vec<-as.vector(unlist(m_HTRU_2_5.50.5.n4)) 
m_HTRU_2_5.50.5.n5<-m_HTRU_2_5.50.5$points_in_vertex[5]
	m_HTRU_2_5.50.5.n5.vec<-as.vector(unlist(m_HTRU_2_5.50.5.n5))
m_HTRU_2_5.50.5.n6<-m_HTRU_2_5.50.5$points_in_vertex[6]
	m_HTRU_2_5.50.5.n6.vec<-as.vector(unlist(m_HTRU_2_5.50.5.n6))


##map the ID’s of each Mapper vertex point to the actual HTRU_2 One Hot DF1 dataset
tda.m_HTRU_2_5.50.5.n1.vec<-HTRU_2[m_HTRU_2_5.50.5.n1.vec,]
tda.m_HTRU_2_5.50.5.n2.vec<-HTRU_2[m_HTRU_2_5.50.5.n2.vec,]
tda.m_HTRU_2_5.50.5.n3.vec<-HTRU_2[m_HTRU_2_5.50.5.n3.vec,]
tda.m_HTRU_2_5.50.5.n4.vec<-HTRU_2[m_HTRU_2_5.50.5.n4.vec,]
tda.m_HTRU_2_5.50.5.n5.vec<-HTRU_2[m_HTRU_2_5.50.5.n5.vec,]
tda.m_HTRU_2_5.50.5.n6.vec<-HTRU_2[m_HTRU_2_5.50.5.n6.vec,]


##*** HTRU_2 Mapper 5 intervals, 40% overlap, 5 bins

m_HTRU_2_5.40.5 <- mapper1D(
     distance_matrix = dist(HTRU_2),
     filter_values = c(ts_pca_b_htru_2$PC1),
     num_intervals = 5,
     percent_overlap = 40,
     num_bins_when_clustering = 5)


g_HTRU_2_5.40.5 <- graph.adjacency(m_HTRU_2_5.40.5$adjacency, mode="undirected")
plot(g_HTRU_2_5.40.5, layout = layout.auto(g_HTRU_2_5.40.5))


head(str(m_HTRU_2_5.40.5$level_of_vertex))

head(str(m_HTRU_2_5.40.5$vertices_in_level))

head(str(m_HTRU_2_5.40.5$points_in_vertex))



my_resolution = 100
my_palette = colorRampPalette(c('red','green','lightblue'))
my_max = max(m_HTRU_2_5.40.5$level_of_vertex, na.rm=TRUE)
my_vector = m_HTRU_2_5.40.5$level_of_vertex / my_max

my_colors = my_palette(my_resolution)[as.numeric(cut(
                       my_vector, breaks=my_resolution))]

g_HTRU_2_5.40.5 <- graph.adjacency(m_HTRU_2_5.40.5$adjacency, mode="undirected")
vertex_size <- unlist(lapply(m_HTRU_2_5.40.5$points_in_vertex,
                             function(x) length(x)))

plot(g_HTRU_2_5.50.5, layout = layout.auto(g_HTRU_2_5.40.5),
     vertex.size = 30*log(vertex_size)/
     max(log(vertex_size)),
     vertex.color = my_colors)

m_HTRU_2_5.40.5.n1<-m_HTRU_2_5.40.5$points_in_vertex[1]
	m_HTRU_2_5.40.5.n1.vec<-as.vector(unlist(m_HTRU_2_5.40.5.n1))
m_HTRU_2_5.40.5.n2<-m_HTRU_2_5.40.5$points_in_vertex[2]
	m_HTRU_2_5.40.5.n2.vec<-as.vector(unlist(m_HTRU_2_5.40.5.n2)) 
m_HTRU_2_5.40.5.n3<-m_HTRU_2_5.40.5$points_in_vertex[3]
	m_HTRU_2_5.40.5.n3.vec<-as.vector(unlist(m_HTRU_2_5.40.5.n3))
m_HTRU_2_5.40.5.n4<-m_HTRU_2_5.40.5$points_in_vertex[4]
	m_HTRU_2_5.40.5.n4.vec<-as.vector(unlist(m_HTRU_2_5.40.5.n4)) 
m_HTRU_2_5.40.5.n5<-m_HTRU_2_5.40.5$points_in_vertex[5]
	m_HTRU_2_5.40.5.n5.vec<-as.vector(unlist(m_HTRU_2_5.40.5.n5))
m_HTRU_2_5.40.5.n6<-m_HTRU_2_5.40.5$points_in_vertex[6]
	m_HTRU_2_5.40.5.n6.vec<-as.vector(unlist(m_HTRU_2_5.40.5.n6))

##map the ID’s of each Mapper vertex point to the actual HTRU_2 One Hot DF1 dataset
tda.m_HTRU_2_5.40.5.n1.vec<-HTRU_2[m_HTRU_2_5.40.5.n1.vec,]
tda.m_HTRU_2_5.40.5.n2.vec<-HTRU_2[m_HTRU_2_5.40.5.n2.vec,]
tda.m_HTRU_2_5.40.5.n3.vec<-HTRU_2[m_HTRU_2_5.40.5.n3.vec,]
tda.m_HTRU_2_5.40.5.n4.vec<-HTRU_2[m_HTRU_2_5.40.5.n4.vec,]
tda.m_HTRU_2_5.40.5.n5.vec<-HTRU_2[m_HTRU_2_5.40.5.n5.vec,]
tda.m_HTRU_2_5.40.5.n6.vec<-HTRU_2[m_HTRU_2_5.40.5.n6.vec,]



##*** HTRU_2 Mapper KDE Filter 5 intervals, 60% overlap, 5 bins

m_kde_HTRU_2_5.60.5 <- mapper1D(
      distance_matrix = dist(HTRU_2),
      filter_values = c(filter.kde.htru_2),
      num_intervals = 5,
      percent_overlap = 60,
      num_bins_when_clustering = 5)


g_kde_HTRU_2_5.60.5 <- graph.adjacency(m_kde_HTRU_2_5.60.5$adjacency, mode="undirected")
plot(g_kde_HTRU_2_5.60.5, layout = layout.auto(g_kde_HTRU_2_5.60.5))

head(str(m_kde_HTRU_2_5.60.5$level_of_vertex))

head(str(m_kde_HTRU_2_5.60.5$vertices_in_level))

head(str(m_kde_HTRU_2_5.60.5$points_in_vertex))



my_resolution = 100
my_palette = colorRampPalette(c('red','green','lightblue'))
my_max = max(m_kde_HTRU_2_5.60.5$level_of_vertex, na.rm=TRUE)
my_vector = m_kde_HTRU_2_5.60.5$level_of_vertex / my_max

my_colors = my_palette(my_resolution)[as.numeric(cut(
                       my_vector, breaks=my_resolution))]

g_kde_HTRU_2_5.50.5 <- graph.adjacency(m_kde_HTRU_2_5.60.5$adjacency, mode="undirected")
vertex_size <- unlist(lapply(m_kde_HTRU_2_5.60.5$points_in_vertex,
                             function(x) length(x)))

plot(g_kde_HTRU_2_5.60.5, layout = layout.auto(g_kde_HTRU_2_5.60.5),
     vertex.size = 30*log(vertex_size)/
     max(log(vertex_size)),
     vertex.color = my_colors)


##Extract the ID observations of each mapper output vertex
m_kde_HTRU_2_5.60.5.n1<-m_kde_HTRU_2_5.60.5$points_in_vertex[1]
	m_kde_HTRU_2_5.60.5.n1.vec<-as.vector(unlist(m_kde_HTRU_2_5.60.5.n1))
m_kde_HTRU_2_5.60.5.n2<-m_kde_HTRU_2_5.60.5$points_in_vertex[2]
	m_kde_HTRU_2_5.60.5.n2.vec<-as.vector(unlist(m_kde_HTRU_2_5.60.5.n2)) 
m_kde_HTRU_2_5.60.5.n3<-m_kde_HTRU_2_5.60.5$points_in_vertex[3]
	m_kde_HTRU_2_5.60.5.n3.vec<-as.vector(unlist(m_kde_HTRU_2_5.60.5.n3))
m_kde_HTRU_2_5.60.5.n4<-m_kde_HTRU_2_5.60.5$points_in_vertex[4]
	m_kde_HTRU_2_5.60.5.n4.vec<-as.vector(unlist(m_kde_HTRU_2_5.60.5.n4)) 
m_kde_HTRU_2_5.60.5.n5<-m_kde_HTRU_2_5.60.5 $points_in_vertex[5]
	m_kde_HTRU_2_5.60.5.n5.vec<-as.vector(unlist(m_kde_HTRU_2_5.60.5.n5))

##map the ID’s of each Mapper vertex point to the actual HTRU_2 One Hot DF1 dataset
tda.m_kde_HTRU_2_5.60.5.n1.vec<-HTRU_2[m_kde_HTRU_2_5.60.5.n1.vec,]
tda.m_kde_HTRU_2_5.60.5.n2.vec<-HTRU_2[m_kde_HTRU_2_5.60.5.n2.vec,]
tda.m_kde_HTRU_2_5.60.5.n3.vec<-HTRU_2[m_kde_HTRU_2_5.60.5.n3.vec,]
tda.m_kde_HTRU_2_5.60.5.n4.vec<-HTRU_2[m_kde_HTRU_2_5.60.5.n4.vec,]
tda.m_kde_HTRU_2_5.60.5.n5.vec<-HTRU_2[m_kde_HTRU_2_5.60.5.n5.vec,]



##*** HTRU_2 Mapper KDE Filter 5 intervals, 50% overlap, 5 bins

m_kde_HTRU_2_5.50.5 <- mapper1D(
     distance_matrix = dist(HTRU_2),
     filter_values = c(filter.kde.htru_2),
     num_intervals = 5,
     percent_overlap = 50,
     num_bins_when_clustering = 5)

g_kde_HTRU_2_5.50.5 <- graph.adjacency(m_kde_HTRU_2_5.50.5$adjacency, mode="undirected")
plot(g_kde_HTRU_2_5.50.5, layout = layout.auto(g_kde_HTRU_2_5.50.5))


head(str(m_kde_HTRU_2_5.50.5$level_of_vertex))

head(str(m_kde_HTRU_2_5.50.5$vertices_in_level))

head(str(m_kde_HTRU_2_5.50.5$points_in_vertex))



my_resolution = 100
my_palette = colorRampPalette(c('red','green','lightblue'))
my_max = max(m_kde_HTRU_2_5.50.5$level_of_vertex, na.rm=TRUE)
my_vector = m_kde_HTRU_2_5.50.5$level_of_vertex / my_max

my_colors = my_palette(my_resolution)[as.numeric(cut(
                       my_vector, breaks=my_resolution))]

g_kde_HTRU_2_5.50.5 <- graph.adjacency(m_kde_HTRU_2_5.50.5$adjacency, mode="undirected")
vertex_size <- unlist(lapply(m_kde_HTRU_2_5.50.5$points_in_vertex,
                             function(x) length(x)))

plot(g_kde_HTRU_2_5.50.5, layout = layout.auto(g_kde_HTRU_2_5.50.5),
     vertex.size = 30*log(vertex_size)/
     max(log(vertex_size)),
     vertex.color = my_colors)



##Extract the ID observations of each mapper output vertex
m_kde_HTRU_2_5.50.5.n1<-m_kde_HTRU_2_5.50.5$points_in_vertex[1]
	m_kde_HTRU_2_5.50.5.n1.vec<-as.vector(unlist(m_kde_HTRU_2_5.50.5.n1))
m_kde_HTRU_2_5.50.5.n2<-m_kde_HTRU_2_5.50.5$points_in_vertex[2]
	m_kde_HTRU_2_5.50.5.n2.vec<-as.vector(unlist(m_kde_HTRU_2_5.50.5.n2)) 
m_kde_HTRU_2_5.50.5.n3<-m_kde_HTRU_2_5.50.5$points_in_vertex[3]
	m_kde_HTRU_2_5.50.5.n3.vec<-as.vector(unlist(m_kde_HTRU_2_5.50.5.n3))
m_kde_HTRU_2_5.50.5.n4<-m_kde_HTRU_2_5.50.5$points_in_vertex[4]
	m_kde_HTRU_2_5.50.5.n4.vec<-as.vector(unlist(m_kde_HTRU_2_5.50.5.n4)) 
m_kde_HTRU_2_5.50.5.n5<-m_kde_HTRU_2_5.50.5 $points_in_vertex[5]
	m_kde_HTRU_2_5.50.5.n5.vec<-as.vector(unlist(m_kde_HTRU_2_5.50.5.n5))

##map the ID’s of each Mapper vertex point to the actual HTRU_2 One Hot DF1 dataset
tda.m_kde_HTRU_2_5.50.5.n1.vec<-HTRU_2[m_kde_HTRU_2_5.50.5.n1.vec,]
tda.m_kde_HTRU_2_5.50.5.n2.vec<-HTRU_2[m_kde_HTRU_2_5.50.5.n2.vec,]
tda.m_kde_HTRU_2_5.50.5.n3.vec<-HTRU_2[m_kde_HTRU_2_5.50.5.n3.vec,]
tda.m_kde_HTRU_2_5.50.5.n4.vec<-HTRU_2[m_kde_HTRU_2_5.50.5.n4.vec,]
tda.m_kde_HTRU_2_5.50.5.n5.vec<-HTRU_2[m_kde_HTRU_2_5.50.5.n5.vec,]




##*** HTRU_2 Mapper KDE 5 intervals, 40% overlap, 5 bins

m_kde_HTRU_2_5.40.5 <- mapper1D(
     distance_matrix = dist(HTRU_2),
     filter_values = c(filter.kde.htru_2),
     num_intervals = 5,
     percent_overlap = 40,
     num_bins_when_clustering = 5)


g_kde_HTRU_2_5.40.5 <- graph.adjacency(m_kde_HTRU_2_5.40.5$adjacency, mode="undirected")
plot(g_kde_HTRU_2_5.40.5, layout = layout.auto(g_kde_HTRU_2_5.40.5))


head(str(m_kde_HTRU_2_5.40.5$level_of_vertex))

head(str(m_kde_HTRU_2_5.40.5$vertices_in_level))

head(str(m_kde_HTRU_2_5.40.5$points_in_vertex))



my_resolution = 100
my_palette = colorRampPalette(c('red','green','lightblue'))
my_max = max(m_kde_HTRU_2_5.40.5$level_of_vertex, na.rm=TRUE)
my_vector = m_kde_HTRU_2_5.40.5$level_of_vertex / my_max

my_colors = my_palette(my_resolution)[as.numeric(cut(
                       my_vector, breaks=my_resolution))]

g_kde_HTRU_2_5.40.5 <- graph.adjacency(m_kde_HTRU_2_5.40.5$adjacency, mode="undirected")
vertex_size <- unlist(lapply(m_kde_HTRU_2_5.40.5$points_in_vertex,
                             function(x) length(x)))

plot(g_kde_HTRU_2_5.40.5, layout = layout.auto(g_kde_HTRU_2_5.40.5),
     vertex.size = 30*log(vertex_size)/
     max(log(vertex_size)),
     vertex.color = my_colors)



##Extract the ID observations of each mapper output vertex
m_kde_HTRU_2_5.40.5.n1<-m_kde_HTRU_2_5.40.5$points_in_vertex[1]
	m_kde_HTRU_2_5.40.5.n1.vec<-as.vector(unlist(m_kde_HTRU_2_5.40.5.n1))
m_kde_HTRU_2_5.40.5.n2<-m_kde_HTRU_2_5.40.5$points_in_vertex[2]
	m_kde_HTRU_2_5.40.5.n2.vec<-as.vector(unlist(m_kde_HTRU_2_5.40.5.n2)) 
m_kde_HTRU_2_5.40.5.n3<-m_kde_HTRU_2_5.40.5$points_in_vertex[3]
	m_kde_HTRU_2_5.40.5.n3.vec<-as.vector(unlist(m_kde_HTRU_2_5.40.5.n3))
m_kde_HTRU_2_5.40.5.n4<-m_kde_HTRU_2_5.40.5$points_in_vertex[4]
	m_kde_HTRU_2_5.40.5.n4.vec<-as.vector(unlist(m_kde_HTRU_2_5.40.5.n4)) 
m_kde_HTRU_2_5.40.5.n5<-m_kde_HTRU_2_5.40.5 $points_in_vertex[5]
	m_kde_HTRU_2_5.40.5.n5.vec<-as.vector(unlist(m_kde_HTRU_2_5.40.5.n5))

##map the ID’s of each Mapper vertex point to the actual HTRU_2 One Hot DF4 dataset
tda.m_kde_HTRU_2_5.40.5.n1.vec<-HTRU_2[m_kde_HTRU_2_5.40.5.n1.vec,]
tda.m_kde_HTRU_2_5.40.5.n2.vec<-HTRU_2[m_kde_HTRU_2_5.40.5.n2.vec,]
tda.m_kde_HTRU_2_5.40.5.n3.vec<-HTRU_2[m_kde_HTRU_2_5.40.5.n3.vec,]
tda.m_kde_HTRU_2_5.40.5.n4.vec<-HTRU_2[m_kde_HTRU_2_5.40.5.n4.vec,]
tda.m_kde_HTRU_2_5.40.5.n5.vec<-HTRU_2[m_kde_HTRU_2_5.40.5.n5.vec,]

```  

```{r Partition_HTRU_2_dataset_into_training_(0,7)_and_test_(0.3)_sest_using_caret}

library(caret)

trainIndex <- createDataPartition(HTRU_2$V9, p = .7, 
                                  list = FALSE, 
                                  times = 1)

head(trainIndex)

HTRU_2Train <- HTRU_2[ trainIndex,]
HTRU_2Test  <- HTRU_2[-trainIndex,]
```

```{r Prepare_Adult_onehot_df4_dataset_for_3_fold_CV}

#Train Control: k-Fold Cross-validation basis for all models 
fitControl <- trainControl(## 10-fold CV
                           method = "cv",
                           number = 3)

```

```{r Fit_the_non_TDA_Assisted_Algorithms_with_the_3-folds_for_cv:_extract_folds_for_TDA_fr}

 

#Non-TDA-Assited
rfGrid<-expand.grid(mtry = (1:20)*50)
#Random Forest 
htru2RfFit <- train(as.factor(V9) ~ ., data = HTRU_2Train, 
                 Importance = T,
                 method = 'rf', 
                 trControl = fitControl,
                 tuneGrid = rfGrid, preProc = c('center','scale'),				      
                 metric='Accuracy')

htru2RfFit
htru2RfFit$resample
htru2_rf_fit_re<-htru2RfFit$resample[1]


summary(htru2RfFit)
vip(htru2RfFit,25) + ggtitle("non-TDA-Assisted: RF")

# Predict outcome using model from training data based on testing data
predictions <- predict(htru2RfFit, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_rf_cf<-confusionMatrix(data=predictions, as.factor(HTRU_2Test$V9))
htru2_rf_cf
htru2_rf_cf$overall
htru2_rf_cf_ov_acc<-htru2_rf_cf$overall[1]
htru2_rf_cf$byClass
htru2_rf_cf_pre_rec_f1<-htru2_rf_cf$byClass[5:7]

##With TDA PCA filter 5 intervals, 50% overlap, 5 bins 
##Node1

htru2_TDA_PC_5.50.5_n1_RfFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n1.vec, 
                 Importance = T,
                 method = 'rf', 
                 trControl = fitControl,
                 tuneGrid = rfGrid, preProc = c('center','scale'), 
                 metric='Accuracy')

htru2_TDA_PC_5.50.5_n1_RfFit0
htru2_TDA_PC_5.50.5_n1_RfFit0$resample
htru2_tda_pc_5.50.5_n1_rf_fit0_re<-htru2_TDA_PC_5.50.5_n1_RfFit0$resample[1]


summary(htru2_TDA_PC_5.50.5_n1_RfFit0)

vip(htru2_TDA_PC_5.50.5_n1_RfFit0,25) + ggtitle("htru2_TDA_PCA_5.50.5_n1_RfFit TDA-Assited RF")


# Predict outcome using htru2_TDA_PC_5.50.5_n1_RfFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n1_RfFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n1_rf_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n1_rf_cf0
htru2_tda_pc_5.50.5_n1_rf_cf0 
htru2_tda_pc_5.50.5_n1_rf_cf0$overall
htru2_tda_pc_5.50.5_n1_rf_cf0_ov_acc<-htru2_tda_pc_5.50.5_n1_rf_cf0$overall[1]
htru2_tda_pc_5.50.5_n1_rf_cf0$byClass
htru2_tda_pc_5.50.5_n1_rf_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n1_rf_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_rf_n1_3_fold<-(htru2_rf_fit_re-htru2_tda_pc_5.50.5_n1_rf_fit0_re)
diff_htru2_tda_pca_5.50.5_rf_n1_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_rf.n1_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n1_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_rf.n1_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_rf.n1_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_rf.n1_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_rf.n1_3_fold$probRight
bst_htru2_tda_pca_5.50.5_rf.n1_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_rf.n1_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n1_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_rf.n1_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_rf.n1_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n1_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_rf.n1_3_fold

# Rope Plot
plot(rope(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n1_3_fold),c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_rf.n1_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_rf_n1_3_fold))
#bf_htru2_tda_pca_5.50.5_rf.n1_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n1_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_rf.n1_test<-(htru2_rf_cf_ov_acc-htru2_tda_pc_5.50.5_n1_rf_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_rf.n1_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_rf.n1_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n1_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_rf.n1_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_rf.n1_test_odds.left<-bst_htru2_tda_pca_5.50.5_rf.n1_test$probLeft/bst_htru2_tda_pca_5.50.5_rf.n1_test$probRight
bst_htru2_tda_pca_5.50.5_rf.n1_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_rf.n1_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n1_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_rf.n1_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_rf.n1_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n1_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_rf.n1_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_rf.n1_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_rf.n1_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_rf.n1_test)) #bf_htru2_tda_pca_5.50.5_rf.n1_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n1_test))

##Node2

htru2_TDA_PC_5.50.5_n2_RfFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n2.vec, 
                 Importance = T,
                 method = 'rf', 
                 trControl = fitControl,
                 tuneGrid = rfGrid, preProc = c('center','scale'), 
                 metric='Accuracy')
				         
htru2_TDA_PC_5.50.5_n2_RfFit0
htru2_TDA_PC_5.50.5_n2_RfFit0$resample
htru2_tda_pc_5.50.5_n2_rf_fit0_re<-htru2_TDA_PC_5.50.5_n2_RfFit0$resample[1]


summary(htru2_TDA_PC_5.50.5_n2_RfFit0)

vip(htru2_TDA_PC_5.50.5_n2_RfFit0,25) + ggtitle("htru2_TDA_PCA_5.50.5_n2_RfFit TDA-Assited RF")


# Predict outcome using htru2_TDA_PC_5.50.5_n2_RfFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n2_RfFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n2_rf_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n2_rf_cf0 
htru2_tda_pc_5.50.5_n2_rf_cf0$overall
htru2_tda_pc_5.50.5_n2_rf_cf0_ov_acc<-htru2_tda_pc_5.50.5_n2_rf_cf0$overall[1]
htru2_tda_pc_5.50.5_n2_rf_cf0$byClass
htru2_tda_pc_5.50.5_n2_rf_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n2_rf_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_rf_n2_3_fold<-(htru2_rf_fit_re-htru2_tda_pc_5.50.5_n2_rf_fit0_re)
diff_htru2_tda_pca_5.50.5_rf_n2_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_rf.n2_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n2_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_rf.n2_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_rf.n2_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_rf.n2_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_rf.n2_3_fold$probRight
bst_htru2_tda_pca_5.50.5_rf.n2_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_rf.n2_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n2_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_rf.n2_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_rf.n2_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n2_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_rf.n2_3_fold

# Rope Plot
plot(rope(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n2_3_fold),c(-0.01,0.01)))


#BayesFactor
#bf_htru2_tda_pca_5.50.5_rf.n2_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_rf_n2_3_fold))
#bf_htru2_tda_pca_5.50.5_rf.n2_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n2_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_rf.n2_test<-(htru2_rf_cf_ov_acc-htru2_tda_pc_5.50.5_n2_rf_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_rf.n2_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_rf.n2_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n2_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_rf.n2_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_rf.n2_test_odds.left<-bst_htru2_tda_pca_5.50.5_rf.n2_test$probLeft/bst_htru2_tda_pca_5.50.5_rf.n2_test$probRight
bst_htru2_tda_pca_5.50.5_rf.n2_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_rf.n2_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n2_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_rf.n2_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_rf.n2_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n2_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_rf.n2_test

# Rope Plot
#plot(rope(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n2_test),c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_rf.n2_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_rf.n2_test)) #bf_htru2_tda_pca_5.50.5_rf.n2_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n2_test))

##Node3

htru2_TDA_PC_5.50.5_n3_RfFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n3.vec, 
                 Importance = T,
                 method = 'rf', 
                 trControl = fitControl,
                 tuneGrid = rfGrid, preProc = c('center','scale'), 
                 metric='Accuracy')

htru2_TDA_PC_5.50.5_n3_RfFit0
htru2_TDA_PC_5.50.5_n3_RfFit0$resample
htru2_tda_pc_5.50.5_n3_rf_fit0_re<-htru2_TDA_PC_5.50.5_n3_RfFit0$resample[1]


summary(htru2_TDA_PC_5.50.5_n3_RfFit0)

vip(htru2_TDA_PC_5.50.5_n3_RfFit0,25) + ggtitle("htru2_TDA_PCA_5.50.5_n3_RfFit TDA-Assited RF")



# Predict outcome using htru2_TDA_PC_5.50.5_n3_RfFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n3_RfFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n3_rf_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n3_rf_cf0
htru2_tda_pc_5.50.5_n3_rf_cf0 
htru2_tda_pc_5.50.5_n3_rf_cf0$overall
htru2_tda_pc_5.50.5_n3_rf_cf0_ov_acc<-htru2_tda_pc_5.50.5_n3_rf_cf0$overall[1]
htru2_tda_pc_5.50.5_n3_rf_cf0$byClass
htru2_tda_pc_5.50.5_n3_rf_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n3_rf_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_rf_n3_3_fold<-(htru2_rf_fit_re-htru2_tda_pc_5.50.5_n3_rf_fit0_re)
diff_htru2_tda_pca_5.50.5_rf_n3_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_rf.n3_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n3_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_rf.n3_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_rf.n3_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_rf.n3_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_rf.n3_3_fold$probRight
bst_htru2_tda_pca_5.50.5_rf.n3_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_rf.n3_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n3_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_rf.n3_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_rf.n3_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n3_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_rf.n2_3_fold

# Rope Plot
plot(rope(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n3_3_fold),c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_rf.n3_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_rf_n3_3_fold))
#bf_htru2_tda_pca_5.50.5_rf.n3_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n3_3_fold))

### Test set diff
diff_htru2_tda_pca_5.50.5_rf.n3_test<-(htru2_rf_cf_ov_acc-htru2_tda_pc_5.50.5_n3_rf_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_rf.n3_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_rf.n3_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n3_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_rf.n3_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_rf.n3_test_odds.left<-bst_htru2_tda_pca_5.50.5_rf.n3_test$probLeft/bst_htru2_tda_pca_5.50.5_rf.n3_test$probRight
bst_htru2_tda_pca_5.50.5_rf.n3_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_rf.n3_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n3_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_rf.n3_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_rf.n3_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n3_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_rf.n3_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_rf.n3_test))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_rf.n3_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_rf.n3_test)) #bf_htru2_tda_pca_5.50.5_rf.n3_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n2_test)

##Node4

htru2_TDA_PC_5.50.5_n4_RfFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n4.vec, 
                 Importance = T,
                 method = 'rf', 
                 trControl = fitControl,
                 tuneGrid = rfGrid, preProc = c('center','scale'), 
                 metric='Accuracy')

htru2_TDA_PC_5.50.5_n4_RfFit0
htru2_TDA_PC_5.50.5_n4_RfFit0$resample
htru2_tda_pc_5.50.5_n4_rf_fit0_re<-htru2_TDA_PC_5.50.5_n4_RfFit0$resample[1]


summary(htru2_TDA_PC_5.50.5_n4_RfFit0)

vip(htru2_TDA_PC_5.50.5_n4_RfFit0,25) + ggtitle("htru2_TDA_PCA_5.50.5_n4_RfFit TDA-Assited RF")



# Predict outcome using htru2_TDA_PC_5.50.5_n4_RfFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n4_RfFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n4_rf_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n4_rf_cf0
htru2_tda_pc_5.50.5_n4_rf_cf0 
htru2_tda_pc_5.50.5_n4_rf_cf0$overall
htru2_tda_pc_5.50.5_n4_rf_cf0_ov_acc<-htru2_tda_pc_5.50.5_n4_rf_cf0$overall[1]
htru2_tda_pc_5.50.5_n4_rf_cf0$byClass
htru2_tda_pc_5.50.5_n4_rf_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n4_rf_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_rf_n4_3_fold<-(htru2_rf_fit_re-htru2_tda_pc_5.50.5_n4_rf_fit0_re)
diff_htru2_tda_pca_5.50.5_rf_n4_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_rf.n4_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n4_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_rf.n4_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_rf.n4_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_rf.n4_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_rf.n4_3_fold$probRight
bst_htru2_tda_pca_5.50.5_rf.n4_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_rf.n4_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n4_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_rf.n4_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_rf.n4_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n4_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_rf.n4_3_fold

# Rope Plot
plot(rope(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n4_3_fold),c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_rf.n4_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_rf_n4_3_fold))
#bf_htru2_tda_pca_5.50.5_rf.n4_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n4_3_fold))

### Test set diff
diff_htru2_tda_pca_5.50.5_rf.n4_test<-(htru2_rf_cf_ov_acc-htru2_tda_pc_5.50.5_n4_rf_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_rf.n4_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_rf.n4_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n4_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_rf.n4_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_rf.n4_test_odds.left<-bst_htru2_tda_pca_5.50.5_rf.n4_test$probLeft/bst_htru2_tda_pca_5.50.5_rf.n4_test$probRight
bst_htru2_tda_pca_5.50.5_rf.n4_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_rf.n4_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n4_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_rf.n4_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_rf.n4_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n4_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_rf.n4_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_rf.n4_test))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_rf.n4_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_rf.n4_test)) #bf_htru2_tda_pca_5.50.5_rf.n4_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n4_test))

##Node5

htru2_TDA_PC_5.50.5_n6_RfFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n6.vec, 
                 Importance = T,
                 method = 'rf', 
                 trControl = fitControl,
                 tuneGrid = rfGrid, preProc = c('center','scale'), 
                 metric='Accuracy')

htru2_TDA_PC_5.50.5_n6_RfFit0
htru2_TDA_PC_5.50.5_n6_RfFit0$resample
htru2_tda_pc_5.50.5_n6_rf_fit0_re<-htru2_TDA_PC_5.50.5_n6_RfFit0$resample[1]


summary(htru2_TDA_PC_5.50.5_n6_RfFit0)

vip(htru2_TDA_PC_5.50.5_n6_RfFit0 ,25) + ggtitle("htru2_TDA_PCA_5.50.5_n6_RfFit TDA-Assited RF")



# Predict outcome using htru2_TDA_PC_5.50.5_n6_RfFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n6_RfFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n6_rf_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n6_rf_cf0
htru2_tda_pc_5.50.5_n6_rf_cf0 
htru2_tda_pc_5.50.5_n6_rf_cf0$overall
htru2_tda_pc_5.50.5_n6_rf_cf0_ov_acc<-htru2_tda_pc_5.50.5_n6_rf_cf0$overall[1]
htru2_tda_pc_5.50.5_n6_rf_cf0$byClass
htru2_tda_pc_5.50.5_n6_rf_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n6_rf_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_rf_n6_3_fold<-(htru2_rf_fit_re-htru2_tda_pc_5.50.5_n6_rf_fit0_re)
diff_htru2_tda_pca_5.50.5_rf_n6_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_rf.n6_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n6_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_rf.n6_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_rf.n6_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_rf.n6_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_rf.n6_3_fold$probRight
bst_htru2_tda_pca_5.50.5_rf.n6_3_fold_odds.left

# Bayesian Signed Rank Test

#bsr_htru2_tda_pca_5.50.5_rf.n6_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n6_3_fold),-0.01,0.01)
#bsr_htru2_tda_pca_5.50.5_rf.n6_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_rf.n6_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n6_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_rf.n6_3_fold

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_rf_n6_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_rf.n6_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_rf_n6_3_fold))
#bf_htru2_tda_pca_5.50.5_rf.n6_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_rf_n6_3_fold))

### Test set diff
diff_htru2_tda_pca_5.50.5_rf.n6_test<-(htru2_rf_cf_ov_acc-htru2_tda_pc_5.50.5_n6_rf_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_rf.n6_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_rf.n6_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n6_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_rf.n6_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_rf.n6_test_odds.left<-bst_htru2_tda_pca_5.50.5_rf.n6_test$probLeft/bst_htru2_tda_pca_5.50.5_rf.n6_test$probRight
bst_htru2_tda_pca_5.50.5_rf.n6_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_rf.n6_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n6_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_rf.n6_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_rf.n6_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n6_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_rf.n6_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_rf.n6_test))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_rf.n6_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_rf.n6_test)) #bf_htru2_tda_pca_5.50.5_rf.n6_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_rf.n6_test))

##With TDA KDE filter 5 intervals, 50% overlap, 5 bins 
##Node1

htru2_TDA_KDE_5.50.5_n1_RfFit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n1.vec, 
                 Importance = T,
                 method = 'rf', 
                 trControl = fitControl,
                 tuneGrid = rfGrid, preProc = c('center','scale'), 
                 metric='Accuracy')

htru2_TDA_KDE_5.50.5_n1_RfFit0
htru2_TDA_KDE_5.50.5_n1_RfFit0$resample
htru2_tda_kde_5.50.5_n1_rf_fit0_re<-htru2_TDA_KDE_5.50.5_n1_RfFit0$resample[1]


summary(htru2_TDA_KDE_5.50.5_n1_RfFit0)

vip(htru2_TDA_KDE_5.50.5_n1_RfFit0,25) + ggtitle("htru2_TDA_KDE_5.50.5_n1_RfFit TDA-Assited RF")



# Predict outcome using htru2_TDA_KDE_5.50.5_n1_RfFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n1_RfFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n1_rf_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n1_rf_cf0
htru2_tda_kde_5.50.5_n1_rf_cf0 
htru2_tda_kde_5.50.5_n1_rf_cf0$overall
htru2_tda_kde_5.50.5_n1_rf_cf0_ov_acc<-htru2_tda_kde_5.50.5_n1_rf_cf0$overall[1]
htru2_tda_kde_5.50.5_n1_rf_cf0$byClass
htru2_tda_kde_5.50.5_n1_rf_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n1_rf_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_rf_n1_3_fold<-(htru2_rf_fit_re-htru2_tda_kde_5.50.5_n1_rf_fit0_re)
diff_htru2_tda_kde_5.50.5_rf_n1_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_rf.n1_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n1_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_rf.n1_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_rf.n1_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_rf.n1_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_rf.n1_3_fold$probRight
bst_htru2_tda_kde_5.50.5_rf.n1_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_rf.n1_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n1_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_rf.n1_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_rf.n1_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n1_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_rf.n1_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_rf_n1_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_rf.n1_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_rf_n1_3_fold))
#bf_htru2_tda_kde_5.50.5_rf.n1_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n1_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_rf.n1_test<-(htru2_rf_cf_ov_acc-htru2_tda_kde_5.50.5_n1_rf_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_rf.n1_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_rf.n1_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n1_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_rf.n1_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_rf.n1_test_odds.left<-bst_htru2_tda_kde_5.50.5_rf.n1_test$probLeft/bst_htru2_tda_kde_5.50.5_rf.n1_test$probRight
bst_htru2_tda_kde_5.50.5_rf.n1_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_rf.n1_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n1_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_rf.n1_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_rf.n1_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n1_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_rf.n1_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_rf.n1_test))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_rf.n1_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_rf.n1_test)) #bf_htru2_tda_kde_5.50.5_rf.n1_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n1_test))

##Node2

htru2_TDA_KDE_5.50.5_n2_RfFit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n2.vec, 
                 Importance = T,
                 method = 'rf', 
                 trControl = fitControl,
                 tuneGrid = rfGrid, preProc = c('center','scale'),				      
                 metric='Accuracy')

htru2_TDA_KDE_5.50.5_n2_RfFit0
htru2_TDA_KDE_5.50.5_n2_RfFit0$resample
htru2_tda_KDE_5.50.5_n2_rf_fit0_re<-htru2_TDA_KDE_5.50.5_n2_RfFit0$resample[1]


summary(htru2_TDA_KDE_5.50.5_n2_RfFit0)

vip(htru2_TDA_KDE_5.50.5_n2_RfFit0,25) + ggtitle("htru2_TDA_KDE_5.50.5_n2_RfFit TDA-Assited RF")


# Predict outcome using htru2_TDA_KDE_5.50.5_n2_RfFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n2_RfFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n2_rf_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n2_rf_cf0
htru2_tda_kde_5.50.5_n2_rf_cf0 
htru2_tda_kde_5.50.5_n2_rf_cf0$overall
htru2_tda_kde_5.50.5_n2_rf_cf0_ov_acc<-htru2_tda_kde_5.50.5_n2_rf_cf0$overall[1]
htru2_tda_kde_5.50.5_n2_rf_cf0$byClass
htru2_tda_kde_5.50.5_n2_rf_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n2_rf_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_rf_n2_3_fold<-(htru2_rf_fit_re-htru2_tda_KDE_5.50.5_n2_rf_fit0_re)
diff_htru2_tda_kde_5.50.5_rf_n2_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_rf.n2_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n2_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_rf.n2_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_rf.n2_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_rf.n2_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_rf.n2_3_fold$probRight
bst_htru2_tda_kde_5.50.5_rf.n2_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_rf.n2_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n2_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_rf.n2_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_rf.n2_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n2_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_rf.n2_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_rf_n2_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_rf.n2_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_rf_n2_3_fold))
#bf_htru2_tda_kde_5.50.5_rf.n2_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n2_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_rf.n2_test<-(htru2_rf_cf_ov_acc-htru2_tda_kde_5.50.5_n2_rf_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_rf.n2_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_rf.n2_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n2_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_rf.n2_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_rf.n2_test_odds.left<-bst_htru2_tda_kde_5.50.5_rf.n2_test$probLeft/bst_htru2_tda_kde_5.50.5_rf.n2_test$probRight
bst_htru2_tda_kde_5.50.5_rf.n2_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_rf.n2_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n2_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_rf.n2_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_rf.n2_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n2_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_rf.n2_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_rf.n2_test))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_rf.n2_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_rf.n2_test)) #bf_htru2_tda_kde_5.50.5_rf.n2_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n2_test))

##Node3

htru2_TDA_KDE_5.50.5_n3_RfFit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n3.vec, 
                 Importance = T,
                 method = 'rf', 
                 trControl = fitControl,
                 tuneGrid = rfGrid, preProc = c('center','scale'),				      
                 metric='Accuracy')

htru2_TDA_KDE_5.50.5_n3_RfFit0
htru2_TDA_KDE_5.50.5_n3_RfFit0$resample
htru2_tda_kde_5.50.5_n3_rf_fit0_re<-htru2_TDA_KDE_5.50.5_n3_RfFit0$resample[1]


summary(htru2_TDA_KDE_5.50.5_n3_RfFit0)

vip(htru2_TDA_KDE_5.50.5_n3_RfFit0,25) + ggtitle("htru2_TDA_KDE_5.50.5_n3_RfFit TDA-Assited RF")


# Predict outcome using htru2_TDA_KDE_5.50.5_n3_RfFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n3_RfFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n3_rf_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n3_rf_cf0
htru2_tda_kde_5.50.5_n3_rf_cf0 
htru2_tda_kde_5.50.5_n3_rf_cf0$overall
htru2_tda_kde_5.50.5_n3_rf_cf0_ov_acc<-htru2_tda_kde_5.50.5_n3_rf_cf0$overall[1]
htru2_tda_kde_5.50.5_n3_rf_cf0$byClass
htru2_tda_kde_5.50.5_n3_rf_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n3_rf_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_rf_n3_3_fold<-(htru2_rf_fit_re-htru2_tda_kde_5.50.5_n3_rf_fit0_re)
diff_htru2_tda_kde_5.50.5_rf_n3_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_rf.n3_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n3_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_rf.n3_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_rf.n3_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_rf.n3_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_rf.n3_3_fold$probRight
bst_htru2_tda_kde_5.50.5_rf.n3_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_rf.n3_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n3_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_rf.n3_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_rf.n3_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n3_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_rf.n3_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_rf_n3_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_rf.n3_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_rf_n3_3_fold))
#bf_htru2_tda_kde_5.50.5_rf.n3_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n3_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_rf.n3_test<-(htru2_rf_cf_ov_acc-htru2_tda_kde_5.50.5_n3_rf_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_rf.n3_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_rf.n3_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n3_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_rf.n3_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_rf.n3_test_odds.left<-bst_htru2_tda_kde_5.50.5_rf.n3_test$probLeft/bst_htru2_tda_kde_5.50.5_rf.n3_test$probRight
bst_htru2_tda_kde_5.50.5_rf.n3_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_rf.n3_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n3_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_rf.n3_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_rf.n3_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n3_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_rf.n3_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_rf.n3_test))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_rf.n3_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_rf.n3_test)) #bf_htru2_tda_kde_5.50.5_rf.n3_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n3_test))

##Node4

htru2_TDA_KDE_5.50.5_n4_RfFit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n4.vec, 
                 Importance = T,
                 method = 'rf', 
                 trControl = fitControl,
                 tuneGrid = rfGrid, preProc = c('center','scale'),				      
                 metric='Accuracy')

htru2_TDA_KDE_5.50.5_n4_RfFit0
htru2_TDA_KDE_5.50.5_n4_RfFit0$resample
htru2_tda_kde_5.50.5_n4_rf_fit0_re<-htru2_TDA_KDE_5.50.5_n4_RfFit0$resample[1]


summary(htru2_TDA_KDE_5.50.5_n4_RfFit0)

vip(htru2_TDA_KDE_5.50.5_n4_RfFit0,25) + ggtitle("htru2_TDA_KDE_5.50.5_n4_RfFit TDA-Assited RF")


# Predict outcome using htru2_TDA_KDE_5.50.5_n4_RfFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n4_RfFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n4_rf_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n4_rf_cf0
htru2_tda_kde_5.50.5_n4_rf_cf0 
htru2_tda_kde_5.50.5_n4_rf_cf0$overall
htru2_tda_kde_5.50.5_n4_rf_cf0_ov_acc<-htru2_tda_kde_5.50.5_n4_rf_cf0$overall[1]
htru2_tda_kde_5.50.5_n4_rf_cf0$byClass
htru2_tda_kde_5.50.5_n4_rf_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n4_rf_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_rf_n4_3_fold<-(htru2_rf_fit_re-htru2_tda_kde_5.50.5_n4_rf_fit0_re)
diff_htru2_tda_kde_5.50.5_rf_n4_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_rf.n4_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n4_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_rf.n4_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_rf.n4_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_rf.n4_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_rf.n4_3_fold$probRight
bst_htru2_tda_kde_5.50.5_rf.n4_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_rf.n4_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n4_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_rf.n4_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_rf.n4_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n4_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_rf.n4_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_rf_n4_3_fold,c(-0.01,0.01)))


### Test set diff
diff_htru2_tda_kde_5.50.5_rf.n4_test<-(htru2_rf_cf_ov_acc-htru2_tda_kde_5.50.5_n4_rf_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_rf.n4_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_rf.n4_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n4_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_rf.n4_test

# Odds Left Bayesian Sign Test 
#BayesFactor
#bf_htru2_tda_kde_5.50.5_rf.n4_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_rf_n4_3_fold))
#bf_htru2_tda_kde_5.50.5_rf.n4_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n4_3_fold))


bst_htru2_tda_kde_5.50.5_rf.n4_test_odds.left<-bst_htru2_tda_kde_5.50.5_rf.n4_test$probLeft/bst_htru2_tda_kde_5.50.5_rf.n4_test$probRight
bst_htru2_tda_kde_5.50.5_rf.n4_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_rf.n4_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n4_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_rf.n4_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_rf.n4_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n4_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_rf.n4_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_rf.n4_test))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_rf.n4_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_rf.n4_test)) #bf_htru2_tda_kde_5.50.5_rf.n4_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n4_test))

##Node5

htru2_TDA_KDE_5.50.5_n5_RfFit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n5.vec, 
                 Importance = T,
                 method = 'rf', 
                 trControl = fitControl,
                 tuneGrid = rfGrid, preProc = c('center','scale'),				      
                 metric='Accuracy')

htru2_TDA_KDE_5.50.5_n5_RfFit0
htru2_TDA_KDE_5.50.5_n5_RfFit0$resample
htru2_tda_kde_5.50.5_n5_rf_fit0_re<-htru2_TDA_KDE_5.50.5_n5_RfFit0$resample[1]


summary(htru2_TDA_KDE_5.50.5_n5_RfFit0)

vip(htru2_TDA_KDE_5.50.5_n5_RfFit0,25) + ggtitle("htru2_TDA_KDE_5.50.5_n5_RfFit TDA-Assited RF")


# Predict outcome using htru2_TDA_KDE_5.50.5_n5_RfFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n5_RfFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n5_rf_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n5_rf_cf0
htru2_tda_kde_5.50.5_n5_rf_cf0 
htru2_tda_kde_5.50.5_n5_rf_cf0$overall
htru2_tda_kde_5.50.5_n5_rf_cf0_ov_acc<-htru2_tda_kde_5.50.5_n5_rf_cf0$overall[1]
htru2_tda_kde_5.50.5_n5_rf_cf0$byClass
htru2_tda_kde_5.50.5_n5_rf_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n5_rf_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_rf_n5_3_fold<-(htru2_rf_fit_re-htru2_tda_kde_5.50.5_n5_rf_fit0_re)
diff_htru2_tda_kde_5.50.5_rf_n5_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_rf.n5_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n5_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_rf.n5_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_rf.n5_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_rf.n5_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_rf.n5_3_fold$probRight
bst_htru2_tda_kde_5.50.5_rf.n5_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_rf.n5_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n5_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_rf.n5_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_rf.n5_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n5_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_rf.n5_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_rf_n5_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_rf.n5_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_rf_n5_3_fold))
#bf_htru2_tda_kde_5.50.5_rf.n5_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_rf_n5_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_rf.n5_test<-(htru2_rf_cf_ov_acc-htru2_tda_kde_5.50.5_n5_rf_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_rf.n5_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_rf.n5_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n5_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_rf.n5_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_rf.n5_test_odds.left<-bst_htru2_tda_kde_5.50.5_rf.n5_test$probLeft/bst_htru2_tda_kde_5.50.5_rf.n5_test$probRight
bst_htru2_tda_kde_5.50.5_rf.n5_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_rf.n5_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n5_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_rf.n5_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_rf.n5_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n5_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_rf.n5_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_rf.n5_test))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_rf.n5_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_rf.n5_test)) #bf_htru2_tda_kde_5.50.5_rf.n5_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_rf.n5_test))

##Non-TDA-Assisted

svmGrid<-expand.grid(sigma = c(0.1, 1, 10), C = (1:5*0.25))

#Support Vector Machine-Radial Basis 
htru2SvmFit <- train(as.factor(V9) ~ ., data = HTRU_2Train, 
                     Importance = T,
                     method = 'svmRadial', 
                     trControl = fitControl,
                     tuneGrid = svmGrid, preProc = c('center','scale'),
                     metric='Accuracy')

htru2SvmFit
htru2SvmFit$resample
htru2_svm_fit_re<-htru2SvmFit$resample[1]

htru2SvmFit
htru2SvmFit$resample
htru2_svm_fit_re<-htru2SvmFit$resample[1]

summary(htru2SvmFit)

#vip(htru2SvmFit, 25) + ggtitle("non-TDA-Assited Svm")

# Predict outcome using model from training data based on testing data
predictions <- predict(htru2SvmFit, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_svm_cf<-confusionMatrix(data=predictions, as.factor(HTRU_2Test$V9))
htru2_svm_cf
htru2_svm_cf$overall
htru2_svm_cf_ov_acc<-htru2_svm_cf$overall[1]
htru2_svm_cf$byClass
htru2_svm_cf_pr_rec_f1<-htru2_svm_cf$byClass[5:7]

##With TDA PCA filter 5 intervals, 50% overlap, 5 bins 
##Node1

htru2_TDA_PC_5.50.5_n1_SvmFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n1.vec, 
                     Importance = T,
                     method = 'svmRadial', 
                     trControl = fitControl,
                     tuneGrid = svmGrid, preProc = c('center','scale'),
                     metric='Accuracy')

htru2_TDA_PC_5.50.5_n1_SvmFit0
htru2_TDA_PC_5.50.5_n1_SvmFit0$resample
htru2_tda_pc_5.50.5_n1_svm_fit_re<-htru2_TDA_PC_5.50.5_n1_SvmFit0 $resample[1]

summary(htru2_TDA_PC_5.50.5_n1_SvmFit0)

#vip(htru2_TDA_PC_5.50.5_n1_SvmFit0,25) + ggtitle("htru2_TDA_PCA_5.50.5_n1_SvmFit TDA-Assited Svm")

# Predict outcome using htru2_TDA_PC_5.50.5_n1_SvmFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n1_SvmFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n1_svm_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n1_svm_cf0
htru2_tda_pc_5.50.5_n1_svm_cf0 
htru2_tda_pc_5.50.5_n1_svm_cf0$overall
htru2_tda_pc_5.50.5_n1_svm_cf0_ov_acc<-htru2_tda_pc_5.50.5_n1_svm_cf0$overall[1]
htru2_tda_pc_5.50.5_n1_svm_cf0$byClass
htru2_tda_pc_5.50.5_n1_svm_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n1_svm_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_svm_n1_3_fold<-(htru2_svm_fit_re - htru2_tda_pc_5.50.5_n1_svm_fit_re)
diff_htru2_tda_pca_5.50.5_svm_n1_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_svm.n1_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n1_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_svm.n1_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_svm.n1_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_svm.n1_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_svm.n1_3_fold$probRight
bst_htru2_tda_pca_5.50.5_svm.n1_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_svm.n1_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n1_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_svm.n1_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_svm.n1_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n1_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_svm.n1_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_svm_n1_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_rf.n1_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_svm_n1_3_fold))
#bf_htru2_tda_pca_5.50.5_rf.n1_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n1_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_svm.n1_test<-(htru2_svm_cf_ov_acc - htru2_tda_pc_5.50.5_n1_svm_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_svm.n1_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_svm.n1_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n1_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_svm.n1_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_svm.n1_test_odds.left<-bst_htru2_tda_pca_5.50.5_svm.n1_test$probLeft/bst_htru2_tda_pca_5.50.5_svm.n1_test$probRight
bst_htru2_tda_pca_5.50.5_svm.n1_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_svm.n1_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n1_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_svm.n1_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_svm.n1_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n1_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_svm.n1_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_svm.n1_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_svm.n1_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_svm.n1_test)) #bf_htru2_tda_pca_5.50.5_svm.n1_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n1_test))

##With TDA PCA filter 5 intervals, 50% overlap, 5 bins 
##Node2

htru2_TDA_PC_5.50.5_n2_SvmFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n2.vec, 
                                        Importance = T,
                                        method = 'svmRadial', 
                                        trControl = fitControl,
                                        tuneGrid = svmGrid, preProc = c('center','scale'),
                                        metric='Accuracy')

htru2_TDA_PC_5.50.5_n2_SvmFit0
htru2_TDA_PC_5.50.5_n2_SvmFit0$resample
htru2_tda_pc_5.50.5_n2_svm_fit_re<-htru2_TDA_PC_5.50.5_n2_SvmFit0 $resample[1]

summary(htru2_TDA_PC_5.50.5_n2_SvmFit0)

#vip(htru2_TDA_PC_5.50.5_n2_SvmFit0,25) + ggtitle("htru2_TDA_PCA_5.50.5_n2_SvmFit TDA-Assited Svm")

# Predict outcome using htru2_TDA_PC_5.50.5_n2_SvmFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n2_SvmFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n2_svm_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n2_svm_cf0
htru2_tda_pc_5.50.5_n2_svm_cf0 
htru2_tda_pc_5.50.5_n2_svm_cf0$overall
htru2_tda_pc_5.50.5_n2_svm_cf0_ov_acc<-htru2_tda_pc_5.50.5_n2_svm_cf0$overall[1]
htru2_tda_pc_5.50.5_n2_svm_cf0$byClass
htru2_tda_pc_5.50.5_n2_svm_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n2_svm_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_svm_n2_3_fold<-(htru2_svm_fit_re - htru2_tda_pc_5.50.5_n2_svm_fit_re)
diff_htru2_tda_pca_5.50.5_svm_n2_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_svm.n2_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n2_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_svm.n2_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_svm.n2_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_svm.n2_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_svm.n2_3_fold$probRight
bst_htru2_tda_pca_5.50.5_svm.n2_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_svm.n2_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n2_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_svm.n2_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_svm.n2_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n2_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_svm.n2_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_svm_n2_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_rf.n2_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_svm_n2_3_fold))
#bf_htru2_tda_pca_5.50.5_rf.n2_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n2_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_svm.n2_test<-(htru2_svm_cf_ov_acc - htru2_tda_pc_5.50.5_n2_svm_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_svm.n2_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_svm.n2_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n2_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_svm.n2_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_svm.n2_test_odds.left<-bst_htru2_tda_pca_5.50.5_svm.n2_test$probLeft/bst_htru2_tda_pca_5.50.5_svm.n2_test$probRight
bst_htru2_tda_pca_5.50.5_svm.n2_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_svm.n2_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n2_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_svm.n2_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_svm.n2_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n2_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_svm.n2_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_svm.n2_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_svm.n2_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_svm.n2_test)) #bf_htru2_tda_pca_5.50.5_svm.n2_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n2_test))

##Node3

htru2_TDA_PC_5.50.5_n3_SvmFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n3.vec, 
                                        Importance = T,
                                        method = 'svmRadial', 
                                        trControl = fitControl,
                                        tuneGrid = svmGrid, preProc = c('center','scale'),
                                        metric='Accuracy')

htru2_TDA_PC_5.50.5_n3_SvmFit0
htru2_TDA_PC_5.50.5_n3_SvmFit0$resample
htru2_tda_pc_5.50.5_n3_svm_fit_re<-htru2_TDA_PC_5.50.5_n3_SvmFit0 $resample[1]

summary(htru2_TDA_PC_5.50.5_n3_SvmFit0)

#vip(htru2_TDA_PC_5.50.5_n3_SvmFit0,25) + ggtitle("htru2_TDA_PCA_5.50.5_n3_SvmFit TDA-Assited Svm")

# Predict outcome using htru2_TDA_PC_5.50.5_n3_SvmFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n3_SvmFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n3_svm_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n3_svm_cf0
htru2_tda_pc_5.50.5_n3_svm_cf0 
htru2_tda_pc_5.50.5_n3_svm_cf0$overall
htru2_tda_pc_5.50.5_n3_svm_cf0_ov_acc<-htru2_tda_pc_5.50.5_n3_svm_cf0$overall[1]
htru2_tda_pc_5.50.5_n3_svm_cf0$byClass
htru2_tda_pc_5.50.5_n3_svm_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n3_svm_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_svm_n3_3_fold<-(htru2_svm_fit_re - htru2_tda_pc_5.50.5_n3_svm_fit_re)
diff_htru2_tda_pca_5.50.5_svm_n3_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_svm.n3_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n3_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_svm.n3_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_svm.n3_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_svm.n3_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_svm.n3_3_fold$probRight
bst_htru2_tda_pca_5.50.5_svm.n3_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_svm.n3_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n3_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_svm.n3_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_svm.n3_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n3_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_svm.n3_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_svm_n3_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_rf.n3_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_svm_n3_3_fold))
#bf_htru2_tda_pca_5.50.5_rf.n3_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n3_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_svm.n3_test<-(htru2_svm_cf_ov_acc - htru2_tda_pc_5.50.5_n3_svm_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_svm.n3_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_svm.n3_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n3_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_svm.n3_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_svm.n3_test_odds.left<-bst_htru2_tda_pca_5.50.5_svm.n3_test$probLeft/bst_htru2_tda_pca_5.50.5_svm.n3_test$probRight
bst_htru2_tda_pca_5.50.5_svm.n3_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_svm.n3_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n3_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_svm.n3_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_svm.n3_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n3_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_svm.n3_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_svm.n3_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_svm.n3_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_svm.n3_test)) #bf_htru2_tda_pca_5.50.5_svm.n3_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n3_test))


##Node4

htru2_TDA_PC_5.50.5_n4_SvmFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n4.vec, 
                                        Importance = T,
                                        method = 'svmRadial', 
                                        trControl = fitControl,
                                        tuneGrid = svmGrid, preProc = c('center','scale'),
                                        metric='Accuracy')

htru2_TDA_PC_5.50.5_n4_SvmFit0
htru2_TDA_PC_5.50.5_n4_SvmFit0$resample
htru2_tda_pc_5.50.5_n4_svm_fit_re<-htru2_TDA_PC_5.50.5_n4_SvmFit0 $resample[1]

summary(htru2_TDA_PC_5.50.5_n4_SvmFit0)
#vip(htru2_TDA_PC_5.50.5_n4_SvmFit0,25) + ggtitle("htru2_TDA_PCA_5.50.5_n4_SvmFit TDA-Assited Svm")

# Predict outcome using htru2_TDA_PC_5.50.5_n4_SvmFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n4_SvmFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n4_svm_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n4_svm_cf0
htru2_tda_pc_5.50.5_n4_svm_cf0 
htru2_tda_pc_5.50.5_n4_svm_cf0$overall
htru2_tda_pc_5.50.5_n4_svm_cf0_ov_acc<-htru2_tda_pc_5.50.5_n4_svm_cf0$overall[1]
htru2_tda_pc_5.50.5_n4_svm_cf0$byClass
htru2_tda_pc_5.50.5_n4_svm_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n4_svm_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_svm_n4_3_fold<-(htru2_svm_fit_re - htru2_tda_pc_5.50.5_n4_svm_fit_re)
diff_htru2_tda_pca_5.50.5_svm_n4_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_svm.n4_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n4_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_svm.n4_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_svm.n4_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_svm.n4_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_svm.n4_3_fold$probRight
bst_htru2_tda_pca_5.50.5_svm.n4_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_svm.n4_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n4_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_svm.n4_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_svm.n4_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n4_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_svm.n4_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_svm_n4_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_rf.n4_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_svm_n4_3_fold))
#bf_htru2_tda_pca_5.50.5_rf.n4_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n4_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_svm.n4_test<-(htru2_svm_cf_ov_acc - htru2_tda_pc_5.50.5_n4_svm_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_svm.n4_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_svm.n4_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n4_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_svm.n4_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_svm.n4_test_odds.left<-bst_htru2_tda_pca_5.50.5_svm.n4_test$probLeft/bst_htru2_tda_pca_5.50.5_svm.n4_test$probRight
bst_htru2_tda_pca_5.50.5_svm.n4_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_svm.n4_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n4_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_svm.n4_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_svm.n4_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n4_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_svm.n4_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_svm.n4_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_svm.n4_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_svm.n4_test)) #bf_htru2_tda_pca_5.50.5_svm.n4_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n4_test))

##Node5

htru2_TDA_PC_5.50.5_n6_SvmFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n6.vec, 
                                        Importance = T,
                                        method = 'svmRadial', 
                                        trControl = fitControl,
                                        tuneGrid = svmGrid, preProc = c('center','scale'),
                                        metric='Accuracy')

htru2_TDA_PC_5.50.5_n6_SvmFit0
htru2_TDA_PC_5.50.5_n6_SvmFit0$resample
htru2_tda_pc_5.50.5_n6_svm_fit_re<-htru2_TDA_PC_5.50.5_n6_SvmFit0 $resample[1]

summary(htru2_TDA_PC_5.50.5_n6_SvmFit0)
#vip(htru2_TDA_PC_5.50.5_n6_SvmFit0,25) + ggtitle("htru2_TDA_PCA_5.50.5_n6_SvmFit TDA-Assited Svm")

# Predict outcome using htru2_TDA_PC_5.50.5_n6_SvmFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n6_SvmFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n6_svm_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n6_svm_cf0
htru2_tda_pc_5.50.5_n6_svm_cf0 
htru2_tda_pc_5.50.5_n6_svm_cf0$overall
htru2_tda_pc_5.50.5_n6_svm_cf0_ov_acc<-htru2_tda_pc_5.50.5_n6_svm_cf0$overall[1]
htru2_tda_pc_5.50.5_n6_svm_cf0$byClass
htru2_tda_pc_5.50.5_n6_svm_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n6_svm_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_svm_n6_3_fold<-(htru2_svm_fit_re - htru2_tda_pc_5.50.5_n6_svm_fit_re)
diff_htru2_tda_pca_5.50.5_svm_n6_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_svm.n6_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n6_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_svm.n6_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_svm.n6_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_svm.n6_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_svm.n6_3_fold$probRight
bst_htru2_tda_pca_5.50.5_svm.n6_3_fold_odds.left

# Bayesian Signed Rank Test

#bsr_htru2_tda_pca_5.50.5_svm.n6_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n6_3_#fold),-0.01,0.01)
#bsr_htru2_tda_pca_5.50.5_svm.n6_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_svm.n6_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n6_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_svm.n6_3_fold

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_svm_n6_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_rf.n6_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_svm_n6_3_fold))
#bf_htru2_tda_pca_5.50.5_rf.n6_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_svm_n6_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_svm.n6_test<-(htru2_svm_cf_ov_acc - htru2_tda_pc_5.50.5_n6_svm_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_svm.n6_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_svm.n6_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n6_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_svm.n6_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_svm.n6_test_odds.left<-bst_htru2_tda_pca_5.50.5_svm.n6_test$probLeft/bst_htru2_tda_pca_5.50.5_svm.n6_test$probRight
bst_htru2_tda_pca_5.50.5_svm.n6_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_svm.n6_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n6_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_svm.n6_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_svm.n6_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n6_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_svm.n6_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_svm.n6_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_svm.n6_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_svm.n6_test)) #bf_htru2_tda_pca_5.50.5_svm.n6_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_svm.n6_test))


##With TDA KDE filter 5 intervals, 50% overlap, 5 bins 
##Node1


htru2_TDA_KDE_5.50.5_n1_SvmFit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n4.vec, 
                                        Importance = T,
                                        method = 'svmRadial', 
                                        trControl = fitControl,
                                        tuneGrid = svmGrid, preProc = c('center','scale'),
                                        metric='Accuracy')



htru2_TDA_KDE_5.50.5_n1_SvmFit0
htru2_TDA_KDE_5.50.5_n1_SvmFit0$resample
htru2_tda_kde_5.50.5_n1_svm_fit_re<-htru2_TDA_KDE_5.50.5_n1_SvmFit0 $resample[1]

summary(htru2_TDA_PC_5.50.5_n1_SvmFit0)

#vip(htru2_TDA_KDE_5.50.5_n1_SvmFit0,25) + ggtitle("htru2_TDA_KDE_5.50.5_n1_SvmFit TDA-Assited Svm")

# Predict outcome using htru2_TDA_KDE_5.50.5_n1_SvmFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n1_SvmFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n1_svm_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n1_svm_cf0
htru2_tda_kde_5.50.5_n1_svm_cf0 
htru2_tda_kde_5.50.5_n1_svm_cf0$overall
htru2_tda_kde_5.50.5_n1_svm_cf0_ov_acc<-htru2_tda_kde_5.50.5_n1_svm_cf0$overall[1]
htru2_tda_kde_5.50.5_n1_svm_cf0$byClass
htru2_tda_kde_5.50.5_n1_svm_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n1_svm_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_svm_n1_3_fold<-(htru2_rf_fit_re - htru2_tda_kde_5.50.5_n1_svm_fit_re)
diff_htru2_tda_kde_5.50.5_svm_n1_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_svm.n1_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n1_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_svm.n1_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_svm.n1_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_svm.n1_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_svm.n1_3_fold$probRight
bst_htru2_tda_kde_5.50.5_svm.n1_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_svm.n1_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n1_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_svm.n1_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_svm.n1_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n1_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_svm.n1_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_svm_n1_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_svm.n1_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_svm_n1_3_fold))
#bf_htru2_tda_kde_5.50.5_svm.n1_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n1_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_svm.n1_test<-(htru2_rf_cf_ov_acc-htru2_tda_kde_5.50.5_n1_svm_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_svm.n1_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_svm.n1_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n1_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_svm.n1_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_svm.n1_test_odds.left<-bst_htru2_tda_kde_5.50.5_svm.n1_test$probLeft/bst_htru2_tda_kde_5.50.5_svm.n1_test$probRight
bst_htru2_tda_kde_5.50.5_svm.n1_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_svm.n1_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n1_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_svm.n1_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_svm.n1_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n1_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_svm.n1_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_svm.n1_test))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_svm.n1_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_svm.n1_test)) #bf_htru2_tda_kde_5.50.5_svm.n1_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n1_test))


##With TDA KDE filter 5 intervals, 50% overlap, 5 bins 
##Node2

htru2_TDA_KDE_5.50.5_n2_SvmFit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n2.vec, 
                                        Importance = T,
                                        method = 'svmRadial', 
                                        trControl = fitControl,
                                        tuneGrid = svmGrid, preProc = c('center','scale'),
                                        metric='Accuracy')

htru2_TDA_KDE_5.50.5_n2_SvmFit0
htru2_TDA_KDE_5.50.5_n2_SvmFit0$resample
htru2_tda_kde_5.50.5_n2_svm_fit_re<-htru2_TDA_KDE_5.50.5_n2_SvmFit0$resample[1]

summary(htru2_TDA_KDE_5.50.5_n2_SvmFit0)

#vip(htru2_TDA_KDE_5.50.5_n2_SvmFit0,25) + ggtitle("htru2_TDA_KDE_5.50.5_n2_SvmFit TDA-Assited Svm")
# Predict outcome using htru2_TDA_KDE_5.50.5_n2_SvmFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n2_SvmFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n2_svm_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n2_svm_cf0
htru2_tda_kde_5.50.5_n2_svm_cf0 
htru2_tda_kde_5.50.5_n2_svm_cf0$overall
htru2_tda_kde_5.50.5_n2_svm_cf0_ov_acc<-htru2_tda_kde_5.50.5_n2_svm_cf0$overall[1]
htru2_tda_kde_5.50.5_n2_svm_cf0$byClass
htru2_tda_kde_5.50.5_n2_svm_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n2_svm_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_svm_n2_3_fold<-(htru2_rf_fit_re - htru2_tda_kde_5.50.5_n2_svm_fit_re)
diff_htru2_tda_kde_5.50.5_svm_n2_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_svm.n2_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n2_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_svm.n2_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_svm.n2_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_svm.n2_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_svm.n2_3_fold$probRight
bst_htru2_tda_kde_5.50.5_svm.n2_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_svm.n2_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n2_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_svm.n2_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_svm.n2_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n2_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_svm.n2_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_svm_n2_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_svm.n2_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_svm_n2_3_fold))
#bf_htru2_tda_kde_5.50.5_svm.n2_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n2_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_svm.n2_test<-(htru2_svm_cf_ov_acc-htru2_tda_kde_5.50.5_n2_svm_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_svm.n2_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_svm.n2_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n2_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_svm.n2_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_svm.n2_test_odds.left<-bst_htru2_tda_kde_5.50.5_svm.n2_test$probLeft/bst_htru2_tda_kde_5.50.5_svm.n2_test$probRight
bst_htru2_tda_kde_5.50.5_svm.n2_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_svm.n2_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n2_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_svm.n2_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_svm.n2_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n2_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_svm.n2_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_svm.n2_test))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_svm.n2_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_svm.n2_test)) #bf_htru2_tda_kde_5.50.5_svm.n2_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n2_test))

##Node3

htru2_TDA_KDE_5.50.5_n3_SvmFit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n3.vec, 
                                        Importance = T,
                                        method = 'svmRadial', 
                                        trControl = fitControl,
                                        tuneGrid = svmGrid, preProc = c('center','scale'),
                                        metric='Accuracy')

htru2_TDA_KDE_5.50.5_n3_SvmFit0
htru2_TDA_KDE_5.50.5_n3_SvmFit0$resample
htru2_tda_kde_5.50.5_n3_svm_fit_re<-htru2_TDA_KDE_5.50.5_n3_SvmFit0 $resample[1]

summary(htru2_TDA_KDE_5.50.5_n3_SvmFit0)

#vip(htru2_TDA_KDE_5.50.5_n3_SvmFit0,25) + ggtitle("htru2_TDA_KDE_5.50.5_n3_SvmFit TDA-Assited Svm")

# Predict outcome using htru2_TDA_KDE_5.50.5_n3_SvmFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n3_SvmFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n3_svm_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n3_svm_cf0
htru2_tda_kde_5.50.5_n3_svm_cf0 
htru2_tda_kde_5.50.5_n3_svm_cf0$overall
htru2_tda_kde_5.50.5_n3_svm_cf0_ov_acc<-htru2_tda_kde_5.50.5_n3_svm_cf0$overall[1]
htru2_tda_kde_5.50.5_n3_svm_cf0$byClass
htru2_tda_kde_5.50.5_n3_svm_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n3_svm_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_svm_n3_3_fold<-(htru2_rf_fit_re - htru2_tda_kde_5.50.5_n3_svm_fit_re)
diff_htru2_tda_kde_5.50.5_svm_n3_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_svm.n3_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n3_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_svm.n3_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_svm.n3_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_svm.n3_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_svm.n3_3_fold$probRight
bst_htru2_tda_kde_5.50.5_svm.n3_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_svm.n3_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n3_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_svm.n3_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_svm.n3_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n3_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_svm.n3_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_svm_n3_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_svm.n3_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_svm_n3_3_fold))
#bf_htru2_tda_kde_5.50.5_svm.n3_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n3_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_svm.n3_test<-(htru2_svm_cf_ov_acc-htru2_tda_kde_5.50.5_n3_svm_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_svm.n3_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_svm.n3_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n3_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_svm.n3_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_svm.n3_test_odds.left<-bst_htru2_tda_kde_5.50.5_svm.n3_test$probLeft/bst_htru2_tda_kde_5.50.5_svm.n3_test$probRight
bst_htru2_tda_kde_5.50.5_svm.n3_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_svm.n3_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n3_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_svm.n3_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_svm.n3_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n3_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_svm.n3_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_svm.n3_test))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_svm.n3_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_svm.n3_test)) #bf_htru2_tda_kde_5.50.5_svm.n3_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n3_test))

##Node4

htru2_TDA_KDE_5.50.5_n4_SvmFit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n4.vec, 
                                        Importance = T,
                                        method = 'svmRadial', 
                                        trControl = fitControl,
                                        tuneGrid = svmGrid, preProc = c('center','scale'),
                                        metric='Accuracy')

htru2_TDA_KDE_5.50.5_n4_SvmFit0
htru2_TDA_KDE_5.50.5_n4_SvmFit0$resample
htru2_tda_kde_5.50.5_n4_svm_fit_re<-htru2_TDA_KDE_5.50.5_n4_SvmFit0 $resample[1]

summary(htru2_TDA_KDE_5.50.5_n4_SvmFit0)
#vip(htru2_TDA_KDE_5.50.5_n4_SvmFit0,25) + ggtitle("htru2_TDA_KDE_5.50.5_n_SvmFit TDA-Assited Svm")

# Predict outcome using htru2_TDA_KDE_5.50.5_n4_SvmFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n4_SvmFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n4_svm_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n4_svm_cf0
htru2_tda_kde_5.50.5_n4_svm_cf0 
htru2_tda_kde_5.50.5_n4_svm_cf0$overall
htru2_tda_kde_5.50.5_n4_svm_cf0_ov_acc<-htru2_tda_kde_5.50.5_n4_svm_cf0$overall[1]
htru2_tda_kde_5.50.5_n4_svm_cf0$byClass
htru2_tda_kde_5.50.5_n4_svm_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n4_svm_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_svm_n4_3_fold<-(htru2_rf_fit_re - htru2_tda_kde_5.50.5_n4_svm_fit_re)
diff_htru2_tda_kde_5.50.5_svm_n4_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_svm.n4_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n4_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_svm.n4_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_svm.n4_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_svm.n4_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_svm.n4_3_fold$probRight
bst_htru2_tda_kde_5.50.5_svm.n4_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_svm.n4_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n4_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_svm.n4_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_svm.n4_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n4_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_svm.n4_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_svm_n4_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_svm.n4_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_svm_n4_3_fold))
#bf_htru2_tda_kde_5.50.5_svm.n4_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n4_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_svm.n4_test<-(htru2_svm_cf_ov_acc-htru2_tda_kde_5.50.5_n4_svm_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_svm.n4_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_svm.n4_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n4_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_svm.n4_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_svm.n4_test_odds.left<-bst_htru2_tda_kde_5.50.5_svm.n4_test$probLeft/bst_htru2_tda_kde_5.50.5_svm.n4_test$probRight
bst_htru2_tda_kde_5.50.5_svm.n4_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_svm.n4_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n4_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_svm.n4_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_svm.n4_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n4_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_svm.n4_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_svm.n4_test))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_svm.n4_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_svm.n4_test)) #bf_htru2_tda_kde_5.50.5_svm.n4_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n4_test))

##Node5

htru2_TDA_KDE_5.50.5_n5_SvmFit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n5.vec, 
                                        Importance = T,
                                        method = 'svmRadial', 
                                        trControl = fitControl,
                                        tuneGrid = svmGrid, preProc = c('center','scale'),
                                        metric='Accuracy')

htru2_TDA_KDE_5.50.5_n5_SvmFit0
htru2_TDA_KDE_5.50.5_n5_SvmFit0$resample
htru2_tda_kde_5.50.5_n5_svm_fit_re<-htru2_TDA_KDE_5.50.5_n5_SvmFit0 $resample[1]

summary(htru2_TDA_KDE_5.50.5_n5_SvmFit0)
#vip(htru2_TDA_KDE_5.50.5_n5_SvmFit0,25) + ggtitle("htru2_TDA_KDE_5.50.5_n5_SvmFit TDA-Assited Svm")

# Predict outcome using htru2_TDA_KDE_5.50.5_n5_SvmFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n5_SvmFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n5_svm_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n5_svm_cf0
htru2_tda_kde_5.50.5_n5_svm_cf0 
htru2_tda_kde_5.50.5_n5_svm_cf0$overall
htru2_tda_kde_5.50.5_n5_svm_cf0_ov_acc<-htru2_tda_kde_5.50.5_n5_svm_cf0$overall[1]
htru2_tda_kde_5.50.5_n5_svm_cf0$byClass
htru2_tda_kde_5.50.5_n5_svm_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n5_svm_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_svm_n5_3_fold<-(htru2_rf_fit_re - htru2_tda_kde_5.50.5_n5_svm_fit_re)
diff_htru2_tda_kde_5.50.5_svm_n5_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_svm.n5_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n5_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_svm.n5_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_svm.n5_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_svm.n5_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_svm.n5_3_fold$probRight
bst_htru2_tda_kde_5.50.5_svm.n5_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_svm.n5_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n5_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_svm.n5_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_svm.n5_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n5_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_svm.n5_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_svm_n5_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_svm.n5_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_svm_n5_3_fold))
#bf_htru2_tda_kde_5.50.5_svm.n5_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_svm_n5_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_svm.n5_test<-(htru2_svm_cf_ov_acc-htru2_tda_kde_5.50.5_n5_svm_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_svm.n5_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_svm.n5_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n5_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_svm.n5_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_svm.n5_test_odds.left<-bst_htru2_tda_kde_5.50.5_svm.n5_test$probLeft/bst_htru2_tda_kde_5.50.5_svm.n5_test$probRight
bst_htru2_tda_kde_5.50.5_svm.n5_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_svm.n5_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n5_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_svm.n5_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_svm.n5_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n5_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_svm.n5_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_svm.n5_test))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_svm.n5_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_svm.n5_test)) #bf_htru2_tda_kde_5.50.5_svm.n5_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_svm.n5_test))


#Non-TDA-Assisted

nn1Grid<-expand.grid(size = c(2,3,5,7), decay = c(0.3,0.5,0.7))
#Neural Network 
htru2Nn1Fit <- train(as.factor(V9) ~ ., data = HTRU_2Train, 
            			    Importance = T,
                      method = 'nnet', 
                      trControl = fitControl,
                      tuneGrid = nn1Grid,
                      metric='Accuracy')

htru2Nn1Fit
htru2Nn1Fit$resample
htru2_nn1_fit_re<-htru2Nn1Fit$resample[1]

summary(htru2Nn1Fit)

vip(htru2Nn1Fit,25) + ggtitle("non-TDA-Assited NN")

# Predict outcome using model from training data based on testing data
predictions <- predict(htru2Nn1Fit, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_nn1_cf<-confusionMatrix(data=predictions, as.factor(HTRU_2Test$V9))
htru2_nn1_cf
htru2_nn1_cf$overall
htru2_nn1_cf_ov_acc<-htru2_nn1_cf$overall[1]
htru2_nn1_cf$byClass 
htru2_nn1_cf_pre_rec_f1<-htru2_nn1_cf$byClass[5:7]

##With TDA PCA filter 5 intervals, 50% overlap, 5 bins 
##Node1

#Neural Network 1
htru2_TDA_PC_5.50.5_n1_NN1Fit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n1.vec, 
			               Importance = T,
                     method = 'nnet', 
                     trControl = fitControl,
                     tuneGrid = nn1Grid,
                     metric='Accuracy')

htru2_TDA_PC_5.50.5_n1_NN1Fit0
htru2_TDA_PC_5.50.5_n1_NN1Fit0$resample
htru2_tda_pc_5.50.5_n1_nn1_fit_re<-htru2_TDA_PC_5.50.5_n1_NN1Fit0$resample[1]

summary(htru2_TDA_PC_5.50.5_n1_NN1Fit0)

vip(htru2_TDA_PC_5.50.5_n1_NN1Fit0,25) + ggtitle("htru2_TDA_PCA_5.50.5_n1_NN1Fit TDA-Assited NN")


# Predict outcome using htru2_TDA_PC_5.50.5_n1_NN1Fit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n1_NN1Fit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n1_nn1_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n1_nn1_cf0
htru2_tda_pc_5.50.5_n1_nn1_cf0 
htru2_tda_pc_5.50.5_n1_nn1_cf0$overall
htru2_tda_pc_5.50.5_n1_nn1_cf0_ov_acc<-htru2_tda_pc_5.50.5_n1_nn1_cf0$overall[1]
htru2_tda_pc_5.50.5_n1_nn1_cf0$byClass
htru2_tda_pc_5.50.5_n1_nn1_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n1_nn1_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_nn1_n1_3_fold<-(htru2_nn1_fit_re - htru2_tda_pc_5.50.5_n1_nn1_fit_re)
diff_htru2_tda_pca_5.50.5_nn1_n1_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nn1.n1_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n1_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nn1.n1_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nn1.n1_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_nn1.n1_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_nn1.n1_3_fold$probRight
bst_htru2_tda_pca_5.50.5_nn1.n1_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nn1.n1_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n1_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nn1.n1_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nn1.n1_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n1_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nn1.n1_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_nn1_n1_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nn1.n1_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n1_3_fold))
#bf_htru2_tda_pca_5.50.5_nn1.n1_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n1_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_nn1.n1_test<-(htru2_nn1_cf_ov_acc - htru2_tda_pc_5.50.5_n1_nn1_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_nn1.n1_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nn1.n1_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n1_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nn1.n1_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nn1.n1_test_odds.left<-bst_htru2_tda_pca_5.50.5_nn1.n1_test$probLeft/bst_htru2_tda_pca_5.50.5_nn1.n1_test$probRight
bst_htru2_tda_pca_5.50.5_nn1.n1_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nn1.n1_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n1_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nn1.n1_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nn1.n1_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n1_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nn1.n1_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_nn1.n1_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nn1.n1_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n1_test)) #bf_htru2_tda_pca_5.50.5_nn1.n1_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n1_test))

##With TDA PCA filter 5 intervals, 50% overlap, 5 bins 
##Node2

##htru2_TDA_PC_5.50.5_n2_NN1Fit0 <- nnet(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n2.vec, size=2, range = 0.6,, type='class')

#Neural Network 1
htru2_TDA_PC_5.50.5_n2_NN1Fit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n2.vec, 
			               Importance = T,
                     method = 'nnet', 
                     trControl = fitControl,
                     tuneGrid = nn1Grid,
                     metric='Accuracy')

htru2_TDA_PC_5.50.5_n2_NN1Fit0
htru2_TDA_PC_5.50.5_n2_NN1Fit0$resample
htru2_tda_pc_5.50.5_n2_nn1_fit_re<-htru2_TDA_PC_5.50.5_n2_NN1Fit0$resample[1]

summary(htru2_TDA_PC_5.50.5_n2_NN1Fit0)

vip(htru2_TDA_PC_5.50.5_n2_NN1Fit0,25) + ggtitle("htru2_TDA_PCA_5.50.5_n2_NN1Fit TDA-Assited NN")


# Predict outcome using htru2_TDA_PC_5.50.5_n2_NN1Fit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n2_NN1Fit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n2_nn1_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n2_nn1_cf0
htru2_tda_pc_5.50.5_n2_nn1_cf0 
htru2_tda_pc_5.50.5_n2_nn1_cf0$overall
htru2_tda_pc_5.50.5_n2_nn1_cf0_ov_acc<-htru2_tda_pc_5.50.5_n2_nn1_cf0$overall[1]
htru2_tda_pc_5.50.5_n2_nn1_cf0$byClass
htru2_tda_pc_5.50.5_n2_nn1_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n2_nn1_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_nn1_n2_3_fold<-(htru2_nn1_fit_re - htru2_tda_pc_5.50.5_n2_nn1_fit_re)
diff_htru2_tda_pca_5.50.5_nn1_n2_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nn1.n2_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n2_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nn1.n2_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nn1.n2_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_nn1.n2_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_nn1.n2_3_fold$probRight
bst_htru2_tda_pca_5.50.5_nn1.n2_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nn1.n2_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n2_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nn1.n2_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nn1.n2_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n2_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nn1.n2_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_nn1_n2_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nn1.n2_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n2_3_fold))
#bf_htru2_tda_pca_5.50.5_nn1.n2_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n2_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_nn1.n2_test<-(htru2_nn1_cf_ov_acc - htru2_tda_pc_5.50.5_n2_nn1_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_nn1.n2_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nn1.n2_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n2_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nn1.n2_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nn1.n2_test_odds.left<-bst_htru2_tda_pca_5.50.5_nn1.n2_test$probLeft/bst_htru2_tda_pca_5.50.5_nn1.n2_test$probRight
bst_htru2_tda_pca_5.50.5_nn1.n2_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nn1.n2_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n2_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nn1.n2_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nn1.n2_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n2_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nn1.n2_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_nn1.n2_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nn1.n2_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n2_test)) #bf_htru2_tda_pca_5.50.5_nn1.n2_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n2_test))


##With TDA PCA filter 5 intervals, 50% overlap, 5 bins 
##Node3

#Neural Network 1
htru2_TDA_PC_5.50.5_n3_NN1Fit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n3.vec, 
			               Importance = T,
                     method = 'nnet', 
                     trControl = fitControl,
                     tuneGrid = nn1Grid,
                     metric='Accuracy')

htru2_TDA_PC_5.50.5_n3_NN1Fit0
htru2_TDA_PC_5.50.5_n3_NN1Fit0$resample
htru2_tda_pc_5.50.5_n3_nn1_fit_re<-htru2_TDA_PC_5.50.5_n3_NN1Fit0$resample[1]

summary(htru2_TDA_PC_5.50.5_n3_NN1Fit0)

vip(htru2_TDA_PC_5.50.5_n3_NN1Fit0,25) + ggtitle("htru2_TDA_PCA_5.50.5_n3_NN1Fit TDA-Assited NN")
# Predict outcome using htru2_TDA_PC_5.50.5_n3_NN1Fit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n3_NN1Fit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n3_nn1_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n3_nn1_cf0
htru2_tda_pc_5.50.5_n3_nn1_cf0 
htru2_tda_pc_5.50.5_n3_nn1_cf0$overall
htru2_tda_pc_5.50.5_n3_nn1_cf0_ov_acc<-htru2_tda_pc_5.50.5_n3_nn1_cf0$overall[1]
htru2_tda_pc_5.50.5_n3_nn1_cf0$byClass
htru2_tda_pc_5.50.5_n3_nn1_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n3_nn1_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_nn1_n3_3_fold<-(htru2_nn1_fit_re - htru2_tda_pc_5.50.5_n3_nn1_fit_re)
diff_htru2_tda_pca_5.50.5_nn1_n3_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nn1.n3_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n3_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nn1.n3_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nn1.n3_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_nn1.n3_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_nn1.n3_3_fold$probRight
bst_htru2_tda_pca_5.50.5_nn1.n3_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nn1.n3_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n3_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nn1.n3_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nn1.n3_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n3_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nn1.n3_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_nn1_n3_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nn1.n3_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n3_3_fold))
#bf_htru2_tda_pca_5.50.5_nn1.n3_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n3_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_nn1.n3_test<-(htru2_nn1_cf_ov_acc - htru2_tda_pc_5.50.5_n3_nn1_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_nn1.n3_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nn1.n3_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n3_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nn1.n3_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nn1.n3_test_odds.left<-bst_htru2_tda_pca_5.50.5_nn1.n3_test$probLeft/bst_htru2_tda_pca_5.50.5_nn1.n3_test$probRight
bst_htru2_tda_pca_5.50.5_nn1.n3_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nn1.n3_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n3_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nn1.n3_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nn1.n3_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n3_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nn1.n3_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_nn1.n3_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nn1.n3_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n3_test)) #bf_htru2_tda_pca_5.50.5_nn1.n3_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n3_test))


##Node4

#Neural Network 1
htru2_TDA_PC_5.50.5_n4_NN1Fit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n4.vec, 
			               Importance = T,
                     method = 'nnet', 
                     trControl = fitControl,
                     tuneGrid = nn1Grid,
                     metric='Accuracy')

htru2_TDA_PC_5.50.5_n4_NN1Fit0
htru2_TDA_PC_5.50.5_n4_NN1Fit0$resample
htru2_tda_pc_5.50.5_n4_nn1_fit_re<-htru2_TDA_PC_5.50.5_n4_NN1Fit0$resample[1]

summary(htru2_TDA_PC_5.50.5_n4_NN1Fit0)

vip(htru2_TDA_PC_5.50.5_n4_NN1Fit0,25) + ggtitle("htru2_TDA_PCA_5.50.5_n4_NN1Fit TDA-Assited NN")

# Predict outcome using htru2_TDA_PC_5.50.5_n4_NN1Fit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n4_NN1Fit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n4_nn1_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n4_nn1_cf0
htru2_tda_pc_5.50.5_n4_nn1_cf0 
htru2_tda_pc_5.50.5_n4_nn1_cf0$overall
htru2_tda_pc_5.50.5_n4_nn1_cf0_ov_acc<-htru2_tda_pc_5.50.5_n4_nn1_cf0$overall[1]
htru2_tda_pc_5.50.5_n4_nn1_cf0$byClass
htru2_tda_pc_5.50.5_n4_nn1_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n4_nn1_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_nn1_n4_3_fold<-(htru2_nn1_fit_re - htru2_tda_pc_5.50.5_n4_nn1_fit_re)
diff_htru2_tda_pca_5.50.5_nn1_n4_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nn1.n4_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n4_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nn1.n4_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nn1.n4_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_nn1.n4_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_nn1.n4_3_fold$probRight
bst_htru2_tda_pca_5.50.5_nn1.n4_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nn1.n4_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n4_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nn1.n4_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nn1.n4_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n4_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nn1.n4_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_nn1_n4_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nn1.n4_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n4_3_fold))
#bf_htru2_tda_pca_5.50.5_nn1.n4_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n4_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_nn1.n4_test<-(htru2_nn1_cf_ov_acc - htru2_tda_pc_5.50.5_n4_nn1_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_nn1.n4_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nn1.n4_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n4_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nn1.n4_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nn1.n4_test_odds.left<-bst_htru2_tda_pca_5.50.5_nn1.n4_test$probLeft/bst_htru2_tda_pca_5.50.5_nn1.n4_test$probRight
bst_htru2_tda_pca_5.50.5_nn1.n4_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nn1.n4_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n4_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nn1.n4_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nn1.n4_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n4_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nn1.n4_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_nn1.n4_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nn1.n4_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n4_test)) #bf_htru2_tda_pca_5.50.5_nn1.n4_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n4_test))


##Node5

#Neural Network 1
htru2_TDA_PC_5.50.5_n6_NN1Fit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n6.vec, 
			               Importance = T,
                     method = 'nnet', 
                     trControl = fitControl,
                     tuneGrid = nn1Grid,
                     metric='Accuracy')

htru2_TDA_PC_5.50.5_n6_NN1Fit0
htru2_TDA_PC_5.50.5_n6_NN1Fit0$resample
htru2_tda_pc_5.50.5_n6_nn1_fit_re<-htru2_TDA_PC_5.50.5_n6_NN1Fit0$resample[1]

summary(htru2_TDA_PC_5.50.5_n6_NN1Fit0)

vip(htru2_TDA_PC_5.50.5_n6_NN1Fit0,25) + ggtitle("htru2_TDA_PCA_5.50.5_n6_NN1Fit TDA-Assited NN")

# Predict outcome using htru2_TDA_PC_5.50.5_n6_NN1Fit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n6_NN1Fit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n6_nn1_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n6_nn1_cf0
htru2_tda_pc_5.50.5_n6_nn1_cf0 
htru2_tda_pc_5.50.5_n6_nn1_cf0$overall
htru2_tda_pc_5.50.5_n6_nn1_cf0_ov_acc<-htru2_tda_pc_5.50.5_n6_nn1_cf0$overall[1]
htru2_tda_pc_5.50.5_n6_nn1_cf0$byClass
htru2_tda_pc_5.50.5_n6_nn1_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n6_nn1_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_nn1_n6_3_fold<-(htru2_nn1_fit_re - htru2_tda_pc_5.50.5_n6_nn1_fit_re)
diff_htru2_tda_pca_5.50.5_nn1_n6_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nn1.n6_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n6_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nn1.n6_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nn1.n6_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_nn1.n6_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_nn1.n6_3_fold$probRight
bst_htru2_tda_pca_5.50.5_nn1.n6_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nn1.n6_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n6_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nn1.n6_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nn1.n6_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n6_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nn1.n6_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_nn1_n6_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nn1.n6_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n6_3_fold))
#bf_htru2_tda_pca_5.50.5_nn1.n6_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nn1_n6_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_nn1.n6_test<-(htru2_nn1_cf_ov_acc - htru2_tda_pc_5.50.5_n6_nn1_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_nn1.n6_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nn1.n6_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n6_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nn1.n6_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nn1.n6_test_odds.left<-bst_htru2_tda_pca_5.50.5_nn1.n6_test$probLeft/bst_htru2_tda_pca_5.50.5_nn1.n6_test$probRight
bst_htru2_tda_pca_5.50.5_nn1.n6_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nn1.n6_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n6_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nn1.n6_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nn1.n6_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n6_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nn1.n6_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_nn1.n6_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nn1.n6_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n6_test)) #bf_htru2_tda_pca_5.50.5_nn1.n6_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nn1.n6_test))


##With TDA KDE filter 5 intervals, 50% overlap, 5 bins 
##Node1

#Neural Network 1
htru2_TDA_KDE_5.50.5_n1_NN1Fit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n1.vec, 
			               Importance = T,
                     method = 'nnet', 
                     trControl = fitControl,
                     tuneGrid = nn1Grid,
                     metric='Accuracy')

htru2_TDA_KDE_5.50.5_n1_NN1Fit0
htru2_TDA_KDE_5.50.5_n1_NN1Fit0$resample
htru2_tda_kde_5.50.5_n1_nn1_fit_re<-htru2_TDA_KDE_5.50.5_n1_NN1Fit0$resample[1]

summary(htru2_TDA_KDE_5.50.5_n1_NN1Fit0)

vip(htru2_TDA_KDE_5.50.5_n1_NN1Fit0,50) + ggtitle("htru2_TDA_KDE_5.50.5_n1_NN1Fit TDA-Assited NN")

# Predict outcome using htru2_TDA_KDE_5.50.5_n1_NN1Fit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n1_NN1Fit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n1_nn1_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n1_nn1_cf0
htru2_tda_kde_5.50.5_n1_nn1_cf0 
htru2_tda_kde_5.50.5_n1_nn1_cf0$overall
htru2_tda_kde_5.50.5_n1_nn1_cf0_ov_acc<-htru2_tda_kde_5.50.5_n1_nn1_cf0$overall[1]
htru2_tda_kde_5.50.5_n1_nn1_cf0$byClass
htru2_tda_kde_5.50.5_n1_nn1_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n1_nn1_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_nn1_n1_3_fold<-(htru2_nn1_fit_re - htru2_tda_kde_5.50.5_n1_nn1_fit_re)
diff_htru2_tda_kde_5.50.5_nn1_n1_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nn1.n1_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n1_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nn1.n1_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nn1.n1_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_nn1.n1_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_nn1.n1_3_fold$probRight
bst_htru2_tda_kde_5.50.5_nn1.n1_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nn1.n1_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n1_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nn1.n1_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nn1.n1_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n1_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nn1.n1_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_nn1_n1_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nn1.n1_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n1_3_fold))
#bf_htru2_tda_kde_5.50.5_nn1.n1_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n1_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_nn1.n1_test<-(htru2_nn1_cf_ov_acc - htru2_tda_kde_5.50.5_n1_nn1_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_nn1.n1_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nn1.n1_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n1_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nn1.n1_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nn1.n1_test_odds.left<-bst_htru2_tda_kde_5.50.5_nn1.n1_test$probLeft/bst_htru2_tda_kde_5.50.5_nn1.n1_test$probRight
bst_htru2_tda_kde_5.50.5_nn1.n1_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nn1.n1_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n1_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nn1.n1_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nn1.n1_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n1_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nn1.n1_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_nn1.n1_test)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nn1.n1_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n1_test)) #bf_htru2_tda_pca_5.50.5_nn1.n1_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n1_test))

##Node2

#Neural Network 1
htru2_TDA_KDE_5.50.5_n2_NN1Fit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n3.vec, 
			               Importance = T,
                     method = 'nnet', 
                     trControl = fitControl,
                     tuneGrid = nn1Grid,
                     metric='Accuracy')

htru2_TDA_KDE_5.50.5_n2_NN1Fit0
htru2_TDA_KDE_5.50.5_n2_NN1Fit0$resample
htru2_tda_kde_5.50.5_n2_nn1_fit_re<-htru2_TDA_KDE_5.50.5_n2_NN1Fit0$resample[1]

summary(htru2_TDA_KDE_5.50.5_n2_NN1Fit0)

vip(htru2_TDA_KDE_5.50.5_n2_NN1Fit0,50) + ggtitle("htru2_TDA_KDE_5.50.5_n2_NN1Fit TDA-Assited NN")

# Predict outcome using htru2_TDA_KDE_5.50.5_n2_NN1Fit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n2_NN1Fit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n2_nn1_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n2_nn1_cf0
htru2_tda_kde_5.50.5_n2_nn1_cf0 
htru2_tda_kde_5.50.5_n2_nn1_cf0$overall
htru2_tda_kde_5.50.5_n2_nn1_cf0_ov_acc<-htru2_tda_kde_5.50.5_n2_nn1_cf0$overall[1]
htru2_tda_kde_5.50.5_n2_nn1_cf0$byClass
htru2_tda_kde_5.50.5_n2_nn1_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n2_nn1_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_nn1_n2_3_fold<-(htru2_nn1_fit_re - htru2_tda_kde_5.50.5_n2_nn1_fit_re)
diff_htru2_tda_kde_5.50.5_nn1_n2_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nn1.n2_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n2_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nn1.n2_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nn1.n2_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_nn1.n2_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_nn1.n2_3_fold$probRight
bst_htru2_tda_kde_5.50.5_nn1.n2_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nn1.n2_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n2_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nn1.n2_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nn1.n2_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n2_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nn1.n2_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_nn1_n2_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nn1.n2_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n2_3_fold))
#bf_htru2_tda_kde_5.50.5_nn1.n2_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n2_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_nn1.n2_test<-(htru2_nn1_cf_ov_acc - htru2_tda_kde_5.50.5_n2_nn1_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_nn1.n2_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nn1.n2_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n2_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nn1.n2_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nn1.n2_test_odds.left<-bst_htru2_tda_kde_5.50.5_nn1.n2_test$probLeft/bst_htru2_tda_kde_5.50.5_nn1.n2_test$probRight
bst_htru2_tda_kde_5.50.5_nn1.n2_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nn1.n2_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n2_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nn1.n2_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nn1.n2_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n2_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nn1.n2_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_nn1.n2_test)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nn1.n2_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n2_test)) #bf_htru2_tda_pca_5.50.5_nn1.n2_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n2_test))

##Node3

#Neural Network 1
htru2_TDA_KDE_5.50.5_n3_NN1Fit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n3.vec, 
			               Importance = T,
                     method = 'nnet', 
                     trControl = fitControl,
                     tuneGrid = nn1Grid,
                     metric='Accuracy')

htru2_TDA_KDE_5.50.5_n3_NN1Fit0
htru2_TDA_KDE_5.50.5_n3_NN1Fit0$resample
htru2_tda_kde_5.50.5_n3_nn1_fit_re<-htru2_TDA_KDE_5.50.5_n3_NN1Fit0$resample[1]

summary(htru2_TDA_KDE_5.50.5_n3_NN1Fit0)

vip(htru2_TDA_KDE_5.50.5_n3_NN1Fit0,50) + ggtitle("htru2_TDA_KDE_5.50.5_n3_NN1Fit TDA-Assited NN")

# Predict outcome using htru2_TDA_KDE_5.50.5_n3_NN1Fit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n3_NN1Fit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n3_nn1_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n3_nn1_cf0
htru2_tda_kde_5.50.5_n3_nn1_cf0 
htru2_tda_kde_5.50.5_n3_nn1_cf0$overall
htru2_tda_kde_5.50.5_n3_nn1_cf0_ov_acc<-htru2_tda_kde_5.50.5_n3_nn1_cf0$overall[1]
htru2_tda_kde_5.50.5_n3_nn1_cf0$byClass
htru2_tda_kde_5.50.5_n3_nn1_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n3_nn1_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_nn1_n3_3_fold<-(htru2_nn1_fit_re - htru2_tda_kde_5.50.5_n3_nn1_fit_re)
diff_htru2_tda_kde_5.50.5_nn1_n3_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nn1.n3_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n3_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nn1.n3_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nn1.n3_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_nn1.n3_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_nn1.n3_3_fold$probRight
bst_htru2_tda_kde_5.50.5_nn1.n3_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nn1.n3_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n3_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nn1.n3_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nn1.n3_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n3_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nn1.n3_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_nn1_n3_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nn1.n3_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n3_3_fold))
#bf_htru2_tda_kde_5.50.5_nn1.n3_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n3_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_nn1.n3_test<-(htru2_nn1_cf_ov_acc - htru2_tda_kde_5.50.5_n3_nn1_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_nn1.n3_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nn1.n3_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n3_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nn1.n3_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nn1.n3_test_odds.left<-bst_htru2_tda_kde_5.50.5_nn1.n3_test$probLeft/bst_htru2_tda_kde_5.50.5_nn1.n3_test$probRight
bst_htru2_tda_kde_5.50.5_nn1.n3_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nn1.n3_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n3_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nn1.n3_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nn1.n3_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n3_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nn1.n3_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_nn1.n3_test)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nn1.n3_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n3_test)) #bf_htru2_tda_pca_5.50.5_nn1.n3_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n3_test))

##Node4

#Neural Network 1
htru2_TDA_KDE_5.50.5_n4_NN1Fit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n4.vec, 
			               Importance = T,
                     method = 'nnet', 
                     trControl = fitControl,
                     tuneGrid = nn1Grid,
                     metric='Accuracy')

htru2_TDA_KDE_5.50.5_n4_NN1Fit0
htru2_TDA_KDE_5.50.5_n4_NN1Fit0$resample
htru2_tda_kde_5.50.5_n4_nn1_fit_re<-htru2_TDA_KDE_5.50.5_n4_NN1Fit0$resample[1]

summary(htru2_TDA_KDE_5.50.5_n4_NN1Fit0)

vip(htru2_TDA_KDE_5.50.5_n4_NN1Fit0,50) + ggtitle("htru2_TDA_KDE_5.50.5_n4_NN1Fit TDA-Assited NN")
 

# Predict outcome using htru2_TDA_KDE_5.50.5_n4_NN1Fit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n4_NN1Fit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n4_nn1_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n4_nn1_cf0
htru2_tda_kde_5.50.5_n4_nn1_cf0 
htru2_tda_kde_5.50.5_n4_nn1_cf0$overall
htru2_tda_kde_5.50.5_n4_nn1_cf0_ov_acc<-htru2_tda_kde_5.50.5_n4_nn1_cf0$overall[1]
htru2_tda_kde_5.50.5_n4_nn1_cf0$byClass
htru2_tda_kde_5.50.5_n4_nn1_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n4_nn1_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_nn1_n4_3_fold<-(htru2_nn1_fit_re - htru2_tda_kde_5.50.5_n4_nn1_fit_re)
diff_htru2_tda_kde_5.50.5_nn1_n4_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nn1.n4_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n4_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nn1.n4_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nn1.n4_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_nn1.n4_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_nn1.n4_3_fold$probRight
bst_htru2_tda_kde_5.50.5_nn1.n4_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nn1.n4_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n4_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nn1.n4_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nn1.n4_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n4_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nn1.n4_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_nn1_n4_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nn1.n4_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n4_3_fold))
#bf_htru2_tda_kde_5.50.5_nn1.n4_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n4_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_nn1.n4_test<-(htru2_nn1_cf_ov_acc - htru2_tda_kde_5.50.5_n4_nn1_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_nn1.n4_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nn1.n4_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n4_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nn1.n4_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nn1.n4_test_odds.left<-bst_htru2_tda_kde_5.50.5_nn1.n4_test$probLeft/bst_htru2_tda_kde_5.50.5_nn1.n4_test$probRight
bst_htru2_tda_kde_5.50.5_nn1.n4_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nn1.n4_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n4_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nn1.n4_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nn1.n4_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n4_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nn1.n4_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_nn1.n4_test)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nn1.n4_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n4_test)) #bf_htru2_tda_pca_5.50.5_nn1.n4_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n4_test))

##Node5

#Neural Network 1

htru2_TDA_KDE_5.50.5_n5_NN1Fit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n5.vec, 
			               Importance = T,
                     method = 'nnet', 
                     trControl = fitControl,
                     tuneGrid = nn1Grid,
                     metric='Accuracy')

htru2_TDA_KDE_5.50.5_n5_NN1Fit0
htru2_TDA_KDE_5.50.5_n5_NN1Fit0$resample
htru2_tda_kde_5.50.5_n5_nn1_fit_re<-htru2_TDA_KDE_5.50.5_n5_NN1Fit0$resample[1]

summary(htru2_TDA_KDE_5.50.5_n5_NN1Fit0)
vip(htru2_TDA_KDE_5.50.5_n5_NN1Fit0,50) + ggtitle("htru2_TDA_KDE_5.50.5_n5_NN1Fit TDA-Assited NN")


# Predict outcome using htru2_TDA_KDE_5.50.5_n5_NN1Fit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n5_NN1Fit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n5_nn1_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n5_nn1_cf0
htru2_tda_kde_5.50.5_n5_nn1_cf0 
htru2_tda_kde_5.50.5_n5_nn1_cf0$overall
htru2_tda_kde_5.50.5_n5_nn1_cf0_ov_acc<-htru2_tda_kde_5.50.5_n5_nn1_cf0$overall[1]
htru2_tda_kde_5.50.5_n5_nn1_cf0$byClass
htru2_tda_kde_5.50.5_n5_nn1_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n5_nn1_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_nn1_n5_3_fold<-(htru2_nn1_fit_re - htru2_tda_kde_5.50.5_n5_nn1_fit_re)
diff_htru2_tda_kde_5.50.5_nn1_n5_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nn1.n5_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n5_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nn1.n5_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nn1.n5_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_nn1.n5_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_nn1.n5_3_fold$probRight
bst_htru2_tda_kde_5.50.5_nn1.n5_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nn1.n5_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n5_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nn1.n5_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nn1.n5_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n5_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nn1.n5_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_nn1_n5_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nn1.n5_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n5_3_fold))
#bf_htru2_tda_kde_5.50.5_nn1.n5_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nn1_n5_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_nn1.n5_test<-(htru2_nn1_cf_ov_acc - htru2_tda_kde_5.50.5_n5_nn1_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_nn1.n5_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nn1.n5_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n5_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nn1.n5_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nn1.n5_test_odds.left<-bst_htru2_tda_kde_5.50.5_nn1.n5_test$probLeft/bst_htru2_tda_kde_5.50.5_nn1.n5_test$probRight
bst_htru2_tda_kde_5.50.5_nn1.n5_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nn1.n4_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n4_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nn1.n4_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nn1.n5_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n5_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nn1.n5_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_nn1.n5_test)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nn1.n5_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n5_test)) #bf_htru2_tda_pca_5.50.5_nn1.n5_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nn1.n5_test)) 


##Logistic Regression 

htru2LrFit <- train(as.factor(V9) ~ ., 
                 data = HTRU_2Train, 
                 family = 'binomial',
			    method = 'glm', 
                 trControl = fitControl,
			    metric='Accuracy')
htru2LrFit
htru2LrFit$resample
htru2_lr_fit_re<-htru2LrFit$resample[1]

summary(htru2LrFit)

#varImp (htru2LrFit)

# Predict outcome using model from training data based on testing data
predictions <- predict(htru2LrFit, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_lr_cf<-confusionMatrix(data=predictions, as.factor(HTRU_2Test$V9))
htru2_lr_cf
htru2_lr_cf$overall
htru2_lr_cf_ov_acc<-htru2_lr_cf$overall[1]
htru2_lr_cf$byClass
htru2_lr_cf_pre_rec_f1<-htru2_lr_cf$byClass[5:7]


##With TDA PCA filter 5 intervals, 50% overlap, 5 bins 
##Node1

htru2_TDA_PC_5.50.5_n1_LrFit0 <- glm(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n1.vec, family = 'binomial')

htru2_TDA_PC_5.50.5_n1_LrFit0 <- train(as.factor(V9) ~ ., 
                 data = tda.m_HTRU_2_5.50.5.n1.vec, 
                    family = 'binomial',
			              method = 'glm', 
                    trControl = fitControl,
			              metric='Accuracy')

htru2_TDA_PC_5.50.5_n1_LrFit0
htru2_TDA_PC_5.50.5_n1_LrFit0$resample
htru2_tda_pc_5.50.5_n1_lr_fit_re<-htru2_TDA_PC_5.50.5_n1_LrFit0$resample[1]

summary(htru2_TDA_PC_5.50.5_n1_LrFit0)

vip(htru2_TDA_PC_5.50.5_n1_LrFit0,50) + ggtitle("htru2_TDA_PCA_5.50.5_n1_Lr1Fit TDA-Assited LR")
# Predict outcome using htru2_TDA_PC_5.50.5_n1_LrFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n1_LrFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n1_lr_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n1_lr_cf0
htru2_tda_pc_5.50.5_n1_lr_cf0 
htru2_tda_pc_5.50.5_n1_lr_cf0$overall
htru2_tda_pc_5.50.5_n1_lr_cf0_ov_acc<-htru2_tda_pc_5.50.5_n1_lr_cf0$overall[1]
htru2_tda_pc_5.50.5_n1_lr_cf0$byClass
htru2_tda_pc_5.50.5_n1_lr_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n1_lr_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted LR vs. tda-assisted LR classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_lr_n1_3_fold<-(htru2_lr_fit_re - htru2_tda_pc_5.50.5_n1_lr_fit_re)
diff_htru2_tda_pca_5.50.5_lr_n1_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_lr.n1_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n1_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_lr.n1_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_lr.n1_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_lr.n1_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_lr.n1_3_fold$probRight
bst_htru2_tda_pca_5.50.5_lr.n1_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_lr.n1_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n1_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_lr.n1_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_lr.n1_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n1_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_lr.n1_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_lr_n1_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_lr.n1_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_lr_n1_3_fold))
#bf_htru2_tda_pca_5.50.5_lr.n1_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n1_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_lr.n1_test<-(htru2_lr_cf_ov_acc - htru2_tda_pc_5.50.5_n1_lr_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_lr.n1_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_lr.n1_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n1_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_lr.n1_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_lr.n1_test_odds.left<-bst_htru2_tda_pca_5.50.5_lr.n1_test$probLeft/bst_htru2_tda_pca_5.50.5_lr.n1_test$probRight
bst_htru2_tda_pca_5.50.5_lr.n1_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_lr.n1_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n1_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_lr.n1_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_lr.n1_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n1_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_lr.n1_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_lr.n1_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_lr.n1_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_lr.n1_test)) #bf_htru2_tda_pca_5.50.5_lr.n1_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n1_test))

##With TDA PCA filter 5 intervals, 50% overlap, 5 bins 
##Node2

htru2_TDA_PC_5.50.5_n2_LrFit0 <- train(as.factor(V9) ~ ., 
                 data = tda.m_HTRU_2_5.50.5.n2.vec, 
                      family = 'binomial',
			                method = 'glm', 
                      trControl = fitControl,
			                metric='Accuracy')

htru2_TDA_PC_5.50.5_n2_LrFit0
htru2_TDA_PC_5.50.5_n2_LrFit0$resample
htru2_tda_pc_5.50.5_n2_lr_fit_re<-htru2_TDA_PC_5.50.5_n2_LrFit0$resample[1]

summary(htru2_TDA_PC_5.50.5_n2_LrFit0)

vip(htru2_TDA_PC_5.50.5_n2_LrFit0,50) + ggtitle("htru2_TDA_PCA_5.50.5_n2_Lr1Fit TDA-Assited LR")

# Predict outcome using htru2_TDA_PC_5.50.5_n2_LrFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n2_LrFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n2_lr_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n2_lr_cf0
htru2_tda_pc_5.50.5_n2_lr_cf0 
htru2_tda_pc_5.50.5_n2_lr_cf0$overall
htru2_tda_pc_5.50.5_n2_lr_cf0_ov_acc<-htru2_tda_pc_5.50.5_n2_lr_cf0$overall[1]
htru2_tda_pc_5.50.5_n2_lr_cf0$byClass
htru2_tda_pc_5.50.5_n2_lr_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n2_lr_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted LR vs. tda-assisted LR classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_lr_n2_3_fold<-(htru2_lr_fit_re - htru2_tda_pc_5.50.5_n2_lr_fit_re)
diff_htru2_tda_pca_5.50.5_lr_n2_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_lr.n2_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n2_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_lr.n2_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_lr.n2_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_lr.n2_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_lr.n2_3_fold$probRight
bst_htru2_tda_pca_5.50.5_lr.n2_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_lr.n2_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n2_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_lr.n2_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_lr.n2_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n2_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_lr.n2_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_lr_n2_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_lr.n2_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_lr_n2_3_fold))
#bf_htru2_tda_pca_5.50.5_lr.n2_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n2_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_lr.n2_test<-(htru2_lr_cf_ov_acc - htru2_tda_pc_5.50.5_n2_lr_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_lr.n2_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_lr.n2_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n2_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_lr.n2_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_lr.n2_test_odds.left<-bst_htru2_tda_pca_5.50.5_lr.n2_test$probLeft/bst_htru2_tda_pca_5.50.5_lr.n2_test$probRight
bst_htru2_tda_pca_5.50.5_lr.n2_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_lr.n2_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n2_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_lr.n2_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_lr.n2_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n2_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_lr.n2_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_lr.n2_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_lr.n2_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_lr.n2_test)) #bf_htru2_tda_pca_5.50.5_lr.n2_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n2_test))

##Node3

htru2_TDA_PC_5.50.5_n3_LrFit0 <- train(as.factor(V9) ~ ., 
                 data = tda.m_HTRU_2_5.50.5.n3.vec, 
                      family = 'binomial',
			                method = 'glm', 
                      trControl = fitControl,
			                metric='Accuracy')

htru2_TDA_PC_5.50.5_n3_LrFit0
htru2_TDA_PC_5.50.5_n3_LrFit0$resample
htru2_tda_pc_5.50.5_n3_lr_fit_re<-htru2_TDA_PC_5.50.5_n2_LrFit0$resample[1]

summary(htru2_TDA_PC_5.50.5_n3_LrFit0)

vip(htru2_TDA_PC_5.50.5_n3_LrFit0,50) + ggtitle("htru2_TDA_PCA_5.50.5_n3_Lr1Fit TDA-Assited LR")

# Predict outcome using htru2_TDA_PC_5.50.5_n3_LrFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n3_LrFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n3_lr_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n3_lr_cf0
htru2_tda_pc_5.50.5_n3_lr_cf0 
htru2_tda_pc_5.50.5_n3_lr_cf0$overall
htru2_tda_pc_5.50.5_n3_lr_cf0_ov_acc<-htru2_tda_pc_5.50.5_n3_lr_cf0$overall[1]
htru2_tda_pc_5.50.5_n3_lr_cf0$byClass
htru2_tda_pc_5.50.5_n3_lr_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n3_lr_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted LR vs. tda-assisted LR classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_lr_n3_3_fold<-(htru2_lr_fit_re - htru2_tda_pc_5.50.5_n3_lr_fit_re)
diff_htru2_tda_pca_5.50.5_lr_n3_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_lr.n3_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n3_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_lr.n3_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_lr.n3_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_lr.n3_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_lr.n3_3_fold$probRight
bst_htru2_tda_pca_5.50.5_lr.n3_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_lr.n3_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n3_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_lr.n3_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_lr.n3_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n3_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_lr.n3_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_lr_n3_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_lr.n3_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_lr_n3_3_fold))
#bf_htru2_tda_pca_5.50.5_lr.n3_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n3_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_lr.n3_test<-(htru2_lr_cf_ov_acc - htru2_tda_pc_5.50.5_n3_lr_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_lr.n3_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_lr.n3_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n3_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_lr.n3_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_lr.n3_test_odds.left<-bst_htru2_tda_pca_5.50.5_lr.n3_test$probLeft/bst_htru2_tda_pca_5.50.5_lr.n3_test$probRight
bst_htru2_tda_pca_5.50.5_lr.n3_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_lr.n3_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n3_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_lr.n3_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_lr.n3_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n3_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_lr.n3_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_lr.n3_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_lr.n3_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_lr.n3_test)) #bf_htru2_tda_pca_5.50.5_lr.n3_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n3_test))

##Node4

htru2_TDA_PC_5.50.5_n4_LrFit0 <- train(as.factor(V9) ~ ., 
                 data = tda.m_HTRU_2_5.50.5.n4.vec, 
                      family = 'binomial',
			                method = 'glm', 
                      trControl = fitControl,
			                metric='Accuracy')

htru2_TDA_PC_5.50.5_n4_LrFit0
htru2_TDA_PC_5.50.5_n4_LrFit0$resample
htru2_tda_pc_5.50.5_n4_lr_fit_re<-htru2_TDA_PC_5.50.5_n4_LrFit0$resample[1]

summary(htru2_TDA_PC_5.50.5_n4_LrFit0)

vip(htru2_TDA_PC_5.50.5_n4_LrFit0,50) + ggtitle("htru2_TDA_PCA_5.50.5_n4_Lr1Fit TDA-Assited LR")

# Predict outcome using htru2_TDA_PC_5.50.5_n4_LrFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n4_LrFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n4_lr_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n4_lr_cf0
htru2_tda_pc_5.50.5_n4_lr_cf0 
htru2_tda_pc_5.50.5_n4_lr_cf0$overall
htru2_tda_pc_5.50.5_n4_lr_cf0_ov_acc<-htru2_tda_pc_5.50.5_n4_lr_cf0$overall[1]
htru2_tda_pc_5.50.5_n4_lr_cf0$byClass
htru2_tda_pc_5.50.5_n4_lr_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n4_lr_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted LR vs. tda-assisted LR classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_lr_n4_3_fold<-(htru2_lr_fit_re - htru2_tda_pc_5.50.5_n4_lr_fit_re)
diff_htru2_tda_pca_5.50.5_lr_n4_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_lr.n4_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n4_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_lr.n4_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_lr.n4_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_lr.n4_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_lr.n4_3_fold$probRight
bst_htru2_tda_pca_5.50.5_lr.n4_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_lr.n4_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n4_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_lr.n4_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_lr.n4_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n4_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_lr.n4_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_lr_n4_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_lr.n4_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_lr_n4_3_fold))
#bf_htru2_tda_pca_5.50.5_lr.n4_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n4_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_lr.n4_test<-(htru2_lr_cf_ov_acc - htru2_tda_pc_5.50.5_n4_lr_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_lr.n4_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_lr.n4_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n4_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_lr.n4_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_lr.n4_test_odds.left<-bst_htru2_tda_pca_5.50.5_lr.n4_test$probLeft/bst_htru2_tda_pca_5.50.5_lr.n4_test$probRight
bst_htru2_tda_pca_5.50.5_lr.n4_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_lr.n4_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n4_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_lr.n4_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_lr.n4_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n4_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_lr.n4_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_lr.n4_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_lr.n4_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_lr.n4_test)) #bf_htru2_tda_pca_5.50.5_lr.n4_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n4_test))

##Node5

htru2_TDA_PC_5.50.5_n6_LrFit0 <- train(as.factor(V9) ~ ., 
                 data = tda.m_HTRU_2_5.50.5.n6.vec, 
                      family = 'binomial',
			                method = 'glm', 
                      trControl = fitControl,
			                metric='Accuracy')

htru2_TDA_PC_5.50.5_n6_LrFit0
htru2_TDA_PC_5.50.5_n6_LrFit0$resample
htru2_tda_pc_5.50.5_n6_lr_fit_re<-htru2_TDA_PC_5.50.5_n6_LrFit0$resample[1]

summary(htru2_TDA_PC_5.50.5_n6_LrFit0)

vip(htru2_TDA_PC_5.50.5_n6_LrFit0,50) + ggtitle("htru2_TDA_PCA_5.50.5_n6_Lr1Fit TDA-Assited LR")

# Predict outcome using htru2_TDA_PC_5.50.5_n6_LrFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n6_LrFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n6_lr_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n6_lr_cf0
htru2_tda_pc_5.50.5_n6_lr_cf0 
htru2_tda_pc_5.50.5_n6_lr_cf0$overall
htru2_tda_pc_5.50.5_n6_lr_cf0_ov_acc<-htru2_tda_pc_5.50.5_n6_lr_cf0$overall[1]
htru2_tda_pc_5.50.5_n6_lr_cf0$byClass
htru2_tda_pc_5.50.5_n6_lr_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n6_lr_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted LR vs. tda-assisted LR classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_lr_n6_3_fold<-(htru2_lr_fit_re - htru2_tda_pc_5.50.5_n6_lr_fit_re)
diff_htru2_tda_pca_5.50.5_lr_n6_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_lr.n6_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n6_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_lr.n6_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_lr.n6_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_lr.n6_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_lr.n6_3_fold$probRight
bst_htru2_tda_pca_5.50.5_lr.n6_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_lr.n6_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n6_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_lr.n6_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_lr.n6_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n6_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_lr.n6_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_lr_n6_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_lr.n6_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_lr_n6_3_fold))
#bf_htru2_tda_pca_5.50.5_lr.n6_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_lr_n6_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_lr.n6_test<-(htru2_lr_cf_ov_acc - htru2_tda_pc_5.50.5_n6_lr_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_lr.n6_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_lr.n6_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n6_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_lr.n6_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_lr.n6_test_odds.left<-bst_htru2_tda_pca_5.50.5_lr.n6_test$probLeft/bst_htru2_tda_pca_5.50.5_lr.n6_test$probRight
bst_htru2_tda_pca_5.50.5_lr.n6_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_lr.n6_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n6_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_lr.n6_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_lr.n6_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n6_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_lr.n6_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_lr.n6_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_lr.n6_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_lr.n6_test)) #bf_htru2_tda_pca_5.50.5_lr.n6_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_lr.n6_test))


##With TDA KDE filter 5 intervals, 50% overlap, 5 bins 
##Node1


htru2_TDA_KDE_5.50.5_n1_LrFit0 <- train(as.factor(V9) ~ ., 
                 data = tda.m_kde_HTRU_2_5.50.5.n1.vec, 
                      family = 'binomial',
			                method = 'glm', 
                      trControl = fitControl,
			                metric='Accuracy')

htru2_TDA_KDE_5.50.5_n1_LrFit0
htru2_TDA_KDE_5.50.5_n1_LrFit0$resample
htru2_tda_kde_5.50.5_n1_lr_fit_re<-htru2_TDA_KDE_5.50.5_n1_LrFit0$resample[1]

summary(htru2_TDA_KDE_5.50.5_n1_LrFit0)

vip(htru2_TDA_KDE_5.50.5_n1_LrFit0,50) + ggtitle("htru2_TDA_KDE_5.50.5_n1_Lr1Fit TDA-Assited LR")

# Predict outcome using htru2_TDA_KDE_5.50.5_n1_LrFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n1_LrFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n1_lr_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n1_lr_cf0
htru2_tda_kde_5.50.5_n1_lr_cf0 
htru2_tda_kde_5.50.5_n1_lr_cf0$overall
htru2_tda_kde_5.50.5_n1_lr_cf0_ov_acc<-htru2_tda_kde_5.50.5_n1_lr_cf0$overall[1]
htru2_tda_kde_5.50.5_n1_lr_cf0$byClass
htru2_tda_kde_5.50.5_n1_lr_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n1_lr_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_lr_n1_3_fold<-(htru2_lr_fit_re - htru2_tda_kde_5.50.5_n1_lr_fit_re)
diff_htru2_tda_kde_5.50.5_lr_n1_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_lr.n1_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n1_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_lr.n1_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_lr.n1_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_lr.n1_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_lr.n1_3_fold$probRight
bst_htru2_tda_kde_5.50.5_lr.n1_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_lr.n1_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n1_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_lr.n1_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_lr.n1_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n1_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_lr.n1_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_lr_n1_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_lr.n1_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_lr_n1_3_fold))
#bf_htru2_tda_kde_5.50.5_lr.n1_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n1_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_lr.n1_test<-(htru2_lr_cf_ov_acc - htru2_tda_kde_5.50.5_n1_lr_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_lr.n1_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_lr.n1_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n1_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_lr.n1_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_lr.n1_test_odds.left<-bst_htru2_tda_kde_5.50.5_lr.n1_test$probLeft/bst_htru2_tda_kde_5.50.5_lr.n1_test$probRight
bst_htru2_tda_kde_5.50.5_lr.n1_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_lr.n1_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n1_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_lr.n1_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_lr.n1_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n1_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_lr.n1_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_lr.n1_test)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_lr.n1_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_lr.n1_test)) #bf_htru2_tda_pca_5.50.5_lr.n1_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n1_test))


##With TDA KDE filter 5 intervals, 50% overlap, 5 bins 
##Node2

htru2_TDA_KDE_5.50.5_n2_LrFit0 <- train(as.factor(V9) ~ ., 
                 data = tda.m_kde_HTRU_2_5.50.5.n2.vec, 
                      family = 'binomial',
			                method = 'glm', 
                      trControl = fitControl,
			                metric='Accuracy')

htru2_TDA_KDE_5.50.5_n2_LrFit0
htru2_TDA_KDE_5.50.5_n2_LrFit0$resample
htru2_tda_kde_5.50.5_n2_lr_fit_re<-htru2_TDA_KDE_5.50.5_n2_LrFit0$resample[1]

summary(htru2_TDA_KDE_5.50.5_n2_LrFit0)

vip(htru2_TDA_KDE_5.50.5_n2_LrFit0,50) + ggtitle("htru2_TDA_KDE_5.50.5_n2_Lr1Fit TDA-Assited LR")

# Predict outcome using htru2_TDA_KDE_5.50.5_n2_LrFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n2_LrFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n2_lr_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n2_lr_cf0
htru2_tda_kde_5.50.5_n2_lr_cf0 
htru2_tda_kde_5.50.5_n2_lr_cf0$overall
htru2_tda_kde_5.50.5_n2_lr_cf0_ov_acc<-htru2_tda_kde_5.50.5_n2_lr_cf0$overall[1]
htru2_tda_kde_5.50.5_n2_lr_cf0$byClass
htru2_tda_kde_5.50.5_n2_lr_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n2_lr_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_lr_n2_3_fold<-(htru2_lr_fit_re - htru2_tda_kde_5.50.5_n2_lr_fit_re)
diff_htru2_tda_kde_5.50.5_lr_n2_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_lr.n2_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n2_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_lr.n2_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_lr.n2_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_lr.n2_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_lr.n2_3_fold$probRight
bst_htru2_tda_kde_5.50.5_lr.n2_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_lr.n2_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n2_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_lr.n2_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_lr.n2_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n2_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_lr.n2_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_lr_n2_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_lr.n2_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_lr_n2_3_fold))
#bf_htru2_tda_kde_5.50.5_lr.n2_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n2_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_lr.n2_test<-(htru2_lr_cf_ov_acc - htru2_tda_kde_5.50.5_n2_lr_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_lr.n2_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_lr.n2_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n2_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_lr.n2_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_lr.n2_test_odds.left<-bst_htru2_tda_kde_5.50.5_lr.n2_test$probLeft/bst_htru2_tda_kde_5.50.5_lr.n2_test$probRight
bst_htru2_tda_kde_5.50.5_lr.n2_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_lr.n2_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n2_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_lr.n2_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_lr.n2_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n2_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_lr.n2_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_lr.n2_test)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_lr.n2_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_lr.n2_test)) #bf_htru2_tda_pca_5.50.5_lr.n2_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n2_test))

##Node3

htru2_TDA_KDE_5.50.5_n3_LrFit0 <- train(as.factor(V9) ~ ., 
                 data = tda.m_kde_HTRU_2_5.50.5.n3.vec, 
                      family = 'binomial',
			                method = 'glm', 
                      trControl = fitControl,
			                metric='Accuracy')

htru2_TDA_KDE_5.50.5_n3_LrFit0
htru2_TDA_KDE_5.50.5_n3_LrFit0$resample
htru2_tda_kde_5.50.5_n3_lr_fit_re<-htru2_TDA_KDE_5.50.5_n2_LrFit0$resample[1]

summary(htru2_TDA_KDE_5.50.5_n3_LrFit0)

vip(htru2_TDA_KDE_5.50.5_n3_LrFit0,50) + ggtitle("htru2_TDA_KDE_5.50.5_n3_Lr1Fit TDA-Assited LR")

# Predict outcome using htru2_TDA_KDE_5.50.5_n3_LrFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n3_LrFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n3_lr_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n3_lr_cf0
htru2_tda_kde_5.50.5_n3_lr_cf0 
htru2_tda_kde_5.50.5_n3_lr_cf0$overall
htru2_tda_kde_5.50.5_n3_lr_cf0_ov_acc<-htru2_tda_kde_5.50.5_n3_lr_cf0$overall[1]
htru2_tda_kde_5.50.5_n3_lr_cf0$byClass
htru2_tda_kde_5.50.5_n3_lr_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n3_lr_cf0$byClass[5:7]


###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_lr_n3_3_fold<-(htru2_lr_fit_re - htru2_tda_kde_5.50.5_n3_lr_fit_re)
diff_htru2_tda_kde_5.50.5_lr_n3_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_lr.n3_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n3_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_lr.n3_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_lr.n3_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_lr.n3_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_lr.n3_3_fold$probRight
bst_htru2_tda_kde_5.50.5_lr.n3_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_lr.n3_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n3_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_lr.n3_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_lr.n3_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n3_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_lr.n3_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_lr_n3_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_lr.n3_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_lr_n3_3_fold))
#bf_htru2_tda_kde_5.50.5_lr.n3_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n3_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_lr.n3_test<-(htru2_lr_cf_ov_acc - htru2_tda_kde_5.50.5_n3_lr_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_lr.n3_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_lr.n3_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n3_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_lr.n3_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_lr.n3_test_odds.left<-bst_htru2_tda_kde_5.50.5_lr.n3_test$probLeft/bst_htru2_tda_kde_5.50.5_lr.n3_test$probRight
bst_htru2_tda_kde_5.50.5_lr.n3_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_lr.n2_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n2_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_lr.n2_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_lr.n3_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n3_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_lr.n3_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_lr.n3_test)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_lr.n3_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_lr.n3_test)) #bf_htru2_tda_pca_5.50.5_lr.n3_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n3_test))

##Node4

htru2_TDA_KDE_5.50.5_n4_LrFit0 <- train(as.factor(V9) ~ ., 
                 data = tda.m_kde_HTRU_2_5.50.5.n4.vec, 
                      family = 'binomial',
			                method = 'glm', 
                      trControl = fitControl,
			                metric='Accuracy')

htru2_TDA_KDE_5.50.5_n4_LrFit0
htru2_TDA_KDE_5.50.5_n4_LrFit0$resample
htru2_tda_kde_5.50.5_n4_lr_fit_re<-htru2_TDA_KDE_5.50.5_n4_LrFit0$resample[1]

summary(htru2_TDA_KDE_5.50.5_n4_LrFit0)

vip(htru2_TDA_KDE_5.50.5_n4_LrFit0,50) + ggtitle("htru2_TDA_KDE_5.50.5_n4_Lr1Fit TDA-Assited LR")

# Predict outcome using htru2_TDA_KDE_5.50.5_n4_LrFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n4_LrFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n4_lr_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n4_lr_cf0
htru2_tda_kde_5.50.5_n4_lr_cf0 
htru2_tda_kde_5.50.5_n4_lr_cf0$overall
htru2_tda_kde_5.50.5_n4_lr_cf0_ov_acc<-htru2_tda_kde_5.50.5_n4_lr_cf0$overall[1]
htru2_tda_kde_5.50.5_n4_lr_cf0$byClass
htru2_tda_kde_5.50.5_n4_lr_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n4_lr_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_lr_n4_3_fold<-(htru2_lr_fit_re - htru2_tda_kde_5.50.5_n4_lr_fit_re)
diff_htru2_tda_kde_5.50.5_lr_n4_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_lr.n4_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n4_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_lr.n4_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_lr.n4_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_lr.n4_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_lr.n4_3_fold$probRight
bst_htru2_tda_kde_5.50.5_lr.n4_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_lr.n4_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n4_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_lr.n4_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_lr.n4_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n4_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_lr.n4_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_lr_n4_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_lr.n4_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_lr_n4_3_fold))
#bf_htru2_tda_kde_5.50.5_lr.n4_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n4_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_lr.n4_test<-(htru2_lr_cf_ov_acc - htru2_tda_kde_5.50.5_n4_lr_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_lr.n4_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_lr.n4_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n4_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_lr.n4_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_lr.n4_test_odds.left<-bst_htru2_tda_kde_5.50.5_lr.n4_test$probLeft/bst_htru2_tda_kde_5.50.5_lr.n4_test$probRight
bst_htru2_tda_kde_5.50.5_lr.n4_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_lr.n4_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n4_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_lr.n4_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_lr.n4_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n4_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_lr.n4_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_lr.n4_test)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_lr.n4_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_lr.n4_test)) #bf_htru2_tda_pca_5.50.5_lr.n4_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n4_test))

##Node5

htru2_TDA_KDE_5.50.5_n5_LrFit0 <- train(as.factor(V9) ~ ., 
                 data = tda.m_kde_HTRU_2_5.50.5.n5.vec, 
                      family = 'binomial',
			                method = 'glm', 
                      trControl = fitControl,
			                metric='Accuracy')

htru2_TDA_KDE_5.50.5_n5_LrFit0
htru2_TDA_KDE_5.50.5_n5_LrFit0$resample
htru2_tda_kde_5.50.5_n5_lr_fit_re<-htru2_TDA_KDE_5.50.5_n5_LrFit0$resample[1]

summary(htru2_TDA_KDE_5.50.5_n5_LrFit0)

vip(htru2_TDA_KDE_5.50.5_n5_LrFit0,50) + ggtitle("htru2_TDA_KDE_5.50.5_n5_Lr1Fit TDA-Assited LR")

# Predict outcome using htru2_TDA_KDE_5.50.5_n5_LrFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n5_LrFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n5_lr_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n5_lr_cf0
htru2_tda_kde_5.50.5_n5_lr_cf0 
htru2_tda_kde_5.50.5_n5_lr_cf0$overall
htru2_tda_kde_5.50.5_n5_lr_cf0_ov_acc<-htru2_tda_kde_5.50.5_n5_lr_cf0$overall[1]
htru2_tda_kde_5.50.5_n5_lr_cf0$byClass
htru2_tda_kde_5.50.5_n5_lr_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n5_lr_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_lr_n5_3_fold<-(htru2_lr_fit_re - htru2_tda_kde_5.50.5_n5_lr_fit_re)
diff_htru2_tda_kde_5.50.5_lr_n5_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_lr.n5_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n5_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_lr.n5_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_lr.n5_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_lr.n5_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_lr.n5_3_fold$probRight
bst_htru2_tda_kde_5.50.5_lr.n5_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_lr.n5_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n5_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_lr.n5_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_lr.n5_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n5_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_lr.n5_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_lr_n5_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_lr.n5_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_lr_n5_3_fold))
#bf_htru2_tda_kde_5.50.5_lr.n5_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_lr_n5_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_lr.n5_test<-(htru2_lr_cf_ov_acc - htru2_tda_kde_5.50.5_n5_lr_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_lr.n5_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_lr.n5_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n5_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_lr.n5_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_lr.n5_test_odds.left<-bst_htru2_tda_kde_5.50.5_lr.n5_test$probLeft/bst_htru2_tda_kde_5.50.5_lr.n5_test$probRight
bst_htru2_tda_kde_5.50.5_lr.n5_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_lr.n5_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n5_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_lr.n5_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_lr.n5_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n5_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_lr.n5_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_lr.n5_test)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_lr.n5_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_lr.n5_test)) #bf_htru2_tda_pca_5.50.5_lr.n5_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_lr.n5_test))


#naiveBayes 
htru2NbFit <- train(as.factor(V9) ~ ., data = HTRU_2Train, 
                method = 'nb', 
                trControl = fitControl,
                metric='Accuracy')

htru2NbFit
htru2NbFit$resample
htru2_nb_fit_re<-htru2NbFit$resample[1]

summary(htru2NbFit)

#varImp (htru2NbFit)



# Predict outcome using model from training data based on testing data
predictions <- predict(htru2NbFit, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_Nb_cf<-confusionMatrix(data=predictions, as.factor(HTRU_2Test$V9))
htru2_Nb_cf
htru2_Nb_cf$overall
htru2_nb_cf_ov_acc<-htru2_Nb_cf$overall[1]
htru2_Nb_cf$byClass
htru2_nb_cf_pre_rec_f1<-htru2_Nb_cf$byClass[5:7]


##With TDA PCA filter 5 intervals, 50% overlap, 5 bins 
##Node1

htru2_TDA_PC_5.50.5_n1_NbFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n1.vec, 
                method = 'nb', 
                trControl = fitControl,
                metric='Accuracy')

htru2_TDA_PC_5.50.5_n1_NbFit0
htru2_TDA_PC_5.50.5_n1_NbFit0$resample
htru2_tda_pc_5.50.5_n1_nb_fit_re<-htru2_TDA_PC_5.50.5_n1_NbFit0$resample[1]

summary(htru2_TDA_PC_5.50.5_n1_NbFit0)

# Predict outcome using htru2_TDA_PC_5.50.5_n1_NbFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n1_NbFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n1_nb_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n1_nb_cf0
htru2_tda_pc_5.50.5_n1_nb_cf0 
htru2_tda_pc_5.50.5_n1_nb_cf0$overall
htru2_tda_pc_5.50.5_n1_nb_cf0_ov_acc<-htru2_tda_pc_5.50.5_n1_nb_cf0$overall[1]
htru2_tda_pc_5.50.5_n1_nb_cf0$byClas1
htru2_tda_pc_5.50.5_n1_nb_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n1_nb_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_nb_n1_3_fold<-(htru2_nb_fit_re - htru2_tda_pc_5.50.5_n1_nb_fit_re)
diff_htru2_tda_pca_5.50.5_nb_n1_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nb.n1_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n1_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nb.n1_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nb.n1_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_nb.n1_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_nb.n1_3_fold$probRight
bst_htru2_tda_pca_5.50.5_nb.n1_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nb.n1_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n1_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nb.n1_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nb.n1_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n1_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nb.n1_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_nb_n1_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nb.n1_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nb_n1_3_fold))
#bf_htru2_tda_pca_5.50.5_nb.n1_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n1_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_nb.n1_test<-(htru2_nb_cf_ov_acc - htru2_tda_pc_5.50.5_n1_nb_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_nb.n1_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nb.n1_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n1_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nb.n1_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nb.n1_test_odds.left<-bst_htru2_tda_pca_5.50.5_nb.n1_test$probLeft/bst_htru2_tda_pca_5.50.5_nb.n1_test$probRight
bst_htru2_tda_pca_5.50.5_nb.n1_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nb.n1_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n1_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nb.n1_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nb.n1_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n1_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nb.n1_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_nb.n1_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nb.n1_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nb.n1_test)) #bf_htru2_tda_pca_5.50.5_nb.n1_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n1_test))

##Node2

htru2_TDA_PC_5.50.5_n2_NbFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n2.vec, 
                method = 'nb', 
                trControl = fitControl,
                metric='Accuracy')

htru2_TDA_PC_5.50.5_n2_NbFit0
htru2_TDA_PC_5.50.5_n2_NbFit0$resample
htru2_tda_pc_5.50.5_n2_nb_fit_re<-htru2_TDA_PC_5.50.5_n2_NbFit0$resample[1]

summary(htru2_TDA_PC_5.50.5_n2_NbFit0)

# Predict outcome using htru2_TDA_PC_5.50.5_n2_NbFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n2_NbFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n2_nb_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n2_nb_cf0
htru2_tda_pc_5.50.5_n2_nb_cf0 
htru2_tda_pc_5.50.5_n2_nb_cf0$overall
htru2_tda_pc_5.50.5_n2_nb_cf0_ov_acc<-htru2_tda_pc_5.50.5_n2_nb_cf0$overall[1]
htru2_tda_pc_5.50.5_n2_nb_cf0$byClass
htru2_tda_pc_5.50.5_n2_nb_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n2_nb_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_nb_n2_3_fold<-(htru2_nb_fit_re - htru2_tda_pc_5.50.5_n2_nb_fit_re)
diff_htru2_tda_pca_5.50.5_nb_n2_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nb.n2_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n2_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nb.n2_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nb.n2_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_nb.n2_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_nb.n2_3_fold$probRight
bst_htru2_tda_pca_5.50.5_nb.n2_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nb.n2_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n2_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nb.n2_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nb.n2_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n2_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nb.n2_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_nb_n2_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nb.n2_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nb_n2_3_fold))
#bf_htru2_tda_pca_5.50.5_nb.n2_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n2_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_nb.n2_test<-(htru2_nb_cf_ov_acc - htru2_tda_pc_5.50.5_n2_nb_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_nb.n2_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nb.n2_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n2_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nb.n2_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nb.n2_test_odds.left<-bst_htru2_tda_pca_5.50.5_nb.n2_test$probLeft/bst_htru2_tda_pca_5.50.5_nb.n2_test$probRight
bst_htru2_tda_pca_5.50.5_nb.n2_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nb.n2_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n2_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nb.n2_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nb.n2_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n2_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nb.n2_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_nb.n2_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nb.n2_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nb.n2_test)) #bf_htru2_tda_pca_5.50.5_nb.n2_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n2_test))

##Node3

htru2_TDA_PC_5.50.5_n3_NbFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n3.vec, 
                method = 'nb', 
                trControl = fitControl,
                metric='Accuracy')

htru2_TDA_PC_5.50.5_n3_NbFit0
htru2_TDA_PC_5.50.5_n3_NbFit0$resample
htru2_tda_pc_5.50.5_n3_nb_fit_re<-htru2_TDA_PC_5.50.5_n3_NbFit0$resample[1]

summary(htru2_TDA_PC_5.50.5_n3_NbFit0)

# Predict outcome using htru2_TDA_PC_5.50.5_n3_NbFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n3_NbFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n3_nb_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n3_nb_cf0
htru2_tda_pc_5.50.5_n3_nb_cf0 
htru2_tda_pc_5.50.5_n3_nb_cf0$overall
htru2_tda_pc_5.50.5_n3_nb_cf0_ov_acc<-htru2_tda_pc_5.50.5_n3_nb_cf0$overall[1]
htru2_tda_pc_5.50.5_n3_nb_cf0$byClass
htru2_tda_pc_5.50.5_n3_nb_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n3_nb_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_nb_n3_3_fold<-(htru2_nb_fit_re - htru2_tda_pc_5.50.5_n3_nb_fit_re)
diff_htru2_tda_pca_5.50.5_nb_n3_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nb.n3_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n3_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nb.n3_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nb.n3_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_nb.n3_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_nb.n3_3_fold$probRight
bst_htru2_tda_pca_5.50.5_nb.n3_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nb.n3_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n3_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nb.n3_3_fold

# Bayesian Correlated Test

#bct_htru2_tda_pca_5.50.5_nb.n3_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n3#_3_fold),0.1,-0.01,0.01)
#bct_htru2_tda_pca_5.50.5_nb.n3_3_fold

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_nb_n3_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nb.n3_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nb_n3_3_fold))
#bf_htru2_tda_pca_5.50.5_nb.n3_3_fold

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n3_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_nb.n3_test<-(htru2_nb_cf_ov_acc - htru2_tda_pc_5.50.5_n3_nb_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_nb.n3_test 

## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nb.n3_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n3_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nb.n3_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nb.n3_test_odds.left<-bst_htru2_tda_pca_5.50.5_nb.n3_test$probLeft/bst_htru2_tda_pca_5.50.5_nb.n3_test$probRight
bst_htru2_tda_pca_5.50.5_nb.n3_test_odds.left

# Bayesian Signed Rank Test

#bsr_htru2_tda_pca_5.50.5_nb.n2_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n2_test),-0.01,0.01)
#bsr_htru2_tda_pca_5.50.5_nb.n2_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nb.n3_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n3_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nb.n3_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_nb.n3_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nb.n3_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nb.n3_test)) #bf_htru2_tda_pca_5.50.5_nb.n3_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n3_test))

##Node4

htru2_TDA_PC_5.50.5_n4_NbFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n4.vec, 
                method = 'nb', 
                trControl = fitControl,
                metric='Accuracy')

htru2_TDA_PC_5.50.5_n4_NbFit0
htru2_TDA_PC_5.50.5_n4_NbFit0$resample
htru2_tda_pc_5.50.5_n4_nb_fit_re<-htru2_TDA_PC_5.50.5_n4_NbFit0$resample[1]

summary(htru2_TDA_PC_5.50.5_n4_NbFit0)

# Predict outcome using htru2_TDA_PC_5.50.5_n4_NbFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_PC_5.50.5_n4_NbFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_pc_5.50.5_n4_nb_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_pc_5.50.5_n4_nb_cf0
htru2_tda_pc_5.50.5_n4_nb_cf0 
htru2_tda_pc_5.50.5_n4_nb_cf0$overall
htru2_tda_pc_5.50.5_n4_nb_cf0_ov_acc<-htru2_tda_pc_5.50.5_n4_nb_cf0$overall[1]
htru2_tda_pc_5.50.5_n4_nb_cf0$byClass
htru2_tda_pc_5.50.5_n4_nb_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n4_nb_cf0$byClass[5:7]


###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_pca_5.50.5_nb_n4_3_fold<-(htru2_nb_fit_re - htru2_tda_pc_5.50.5_n4_nb_fit_re)
diff_htru2_tda_pca_5.50.5_nb_n4_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nb.n4_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n4_3_fold),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nb.n4_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nb.n4_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_nb.n4_3_fold$probLeft/bst_htru2_tda_pca_5.50.5_nb.n4_3_fold$probRight
bst_htru2_tda_pca_5.50.5_nb.n4_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nb.n4_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n4_3_fold),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nb.n4_3_fold

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nb.n4_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n4_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nb.n4_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_pca_5.50.5_nb_n4_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nb.n4_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nb_n4_3_fold))
#bf_htru2_tda_pca_5.50.5_nb.n4_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n4_3_fold))


### Test set diff
diff_htru2_tda_pca_5.50.5_nb.n4_test<-(htru2_nb_cf_ov_acc - htru2_tda_pc_5.50.5_n4_nb_cf0_ov_acc)
diff_htru2_tda_pca_5.50.5_nb.n4_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_pca_5.50.5_nb.n4_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n4_test),-0.01,0.01)
bst_htru2_tda_pca_5.50.5_nb.n4_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_pca_5.50.5_nb.n4_test_odds.left<-bst_htru2_tda_pca_5.50.5_nb.n4_test$probLeft/bst_htru2_tda_pca_5.50.5_nb.n4_test$probRight
bst_htru2_tda_pca_5.50.5_nb.n4_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_pca_5.50.5_nb.n4_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n4_test),-0.01,0.01)
bsr_htru2_tda_pca_5.50.5_nb.n4_test

# Bayesian Correlated Test

bct_htru2_tda_pca_5.50.5_nb.n4_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n4_test),0.1,-0.01,0.01)
bct_htru2_tda_pca_5.50.5_nb.n4_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_nb.n4_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nb.n4_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nb.n4_test)) #bf_htru2_tda_pca_5.50.5_nb.n4_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n4_test))

##Node5

#htru2_TDA_PC_5.50.5_n6_NbFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n6.vec, 
#                method = 'nb', 
#                trControl = fitControl,
#                metric='Accuracy')
#
##htru2_TDA_PC_5.50.5_n6_NbFit0
#htru2_TDA_PC_5.50.5_n6_NbFit0$resample
#htru2_tda_pc_5.50.5_n6_nb_fit_re<-htru2_TDA_PC_5.50.5_n6_NbFit0$resample[1]

#summary(htru2_TDA_PC_5.50.5_n6_NbFit0)

# Predict outcome using htru2_TDA_PC_5.50.5_n6_NbFit0 from training data based on testing data
#pred0 <- predict(htru2_TDA_PC_5.50.5_n6_NbFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
#htru2_tda_pc_5.50.5_n6_nb_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
#htru2_tda_pc_5.50.5_n6_nb_cf0
#htru2_tda_pc_5.50.5_n6_nb_cf0 
#htru2_tda_pc_5.50.5_n6_nb_cf0$overall
#htru2_tda_pc_5.50.5_n6_nb_cf0_ov_acc<-htru2_tda_pc_5.50.5_n6_nb_cf0$overall[1]
#htru2_tda_pc_5.50.5_n6_nb_cf0$byClass
#htru2_tda_pc_5.50.5_n6_nb_cf0_pre_rec_f1<-htru2_tda_pc_5.50.5_n6_nb_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

#diff_htru2_tda_pca_5.50.5_nb_n6_3_fold<-(htru2_nb_fit_re - htru2_tda_pc_5.50.5_n6_nb_fit_re)
#diff_htru2_tda_pca_5.50.5_nb_n6_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

#bst_htru2_tda_pca_5.50.5_nb.n6_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n6_3_fol#d),-0.01,0.01)
#bst_htru2_tda_pca_5.50.5_nb.n6_3_fold

# Odds Left Bayesian Sign Test 

#bst_htru2_tda_pca_5.50.5_nb.n6_3_fold_odds.left<-bst_htru2_tda_pca_5.50.5_nb.n6_3_fold$probLeft/bst_htr#u2_tda_pca_5.50.5_nb.n6_3_fold$probRight
#bst_htru2_tda_pca_5.50.5_nb.n6_3_fold_odds.left

# Bayesian Signed Rank Test

#bsr_htru2_tda_pca_5.50.5_nb.n6_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n4_3_f#old),-0.01,0.01)
#bsr_htru2_tda_pca_5.50.5_nb.n6_3_fold

# Bayesian Correlated Test

#bct_htru2_tda_pca_5.50.5_nb.n6_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n#6_3_fold),0.1,-0.01,0.01)
#bct_htru2_tda_pca_5.50.5_nb.n6_3_fold

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_nb_n6_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nb.n6_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nb_n6_3_fold))
#bf_htru2_tda_pca_5.50.5_nb.n6_3_fold

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nb_n6_3_fold))


### Test set diff
#diff_htru2_tda_pca_5.50.5_nb.n6_test<-(htru2_nb_cf_ov_acc - htru2_tda_pc_5.50.5_n6_nb_cf0_ov_acc)
#diff_htru2_tda_pca_5.50.5_nb.n6_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

#bst_htru2_tda_pca_5.50.5_nb.n6_test<-BayesianSignTest(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n6_test),-#0.01,0.01)
#bst_htru2_tda_pca_5.50.5_nb.n6_test

# Odds Left Bayesian Sign Test 

#bst_htru2_tda_pca_5.50.5_nb.n6_test_odds.left<-bst_htru2_tda_pca_5.50.5_nb.n6_test$probLeft/bst_htru2_t#da_pca_5.50.5_nb.n6_test$probRight
#bst_htru2_tda_pca_5.50.5_nb.n6_test_odds.left

# Bayesian Signed Rank Test

#bsr_htru2_tda_pca_5.50.5_nb.n6_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n6_test)#,-0.01,0.01)
#bsr_htru2_tda_pca_5.50.5_nb.n6_test

# Bayesian Correlated Test

#bct_htru2_tda_pca_5.50.5_nb.n6_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n6_#test),0.1,-0.01,0.01)
#bct_htru2_tda_pca_5.50.5_nb.n6_test

# Rope Plot
#plot(rope(diff_htru2_tda_pca_5.50.5_nb.n6_test)))

#BayesFactor
#bf_htru2_tda_pca_5.50.5_nb.n6_test = ttestBF(x = as.matrix(diff_htru2_tda_pca_5.50.5_nb.n6_test)) #bf_htru2_tda_pca_5.50.5_nb.n6_test

#t_test
#t.test(as.matrix(diff_htru2_tda_pca_5.50.5_nb.n6_test))

##With TDA KDE filter 5 intervals, 50% overlap, 5 bins 
##Node1

htru2_TDA_KDE_5.50.5_n1_NbFit0 <- train(as.factor(V9) ~ ., data = tda.m_kde_HTRU_2_5.50.5.n1.vec, 
                method = 'nb', 
                trControl = fitControl,
                metric='Accuracy')

htru2_TDA_KDE_5.50.5_n1_NbFit0
htru2_TDA_KDE_5.50.5_n1_NbFit0$resample
htru2_tda_kde_5.50.5_n1_nb_fit_re<-htru2_TDA_KDE_5.50.5_n1_NbFit0$resample[1]

summary(htru2_TDA_KDE_5.50.5_n1_NbFit0)

# Predict outcome using htru2_TDA_KDE_5.50.5_n1_NbFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n1_NbFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n1_nb_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n1_nb_cf0
htru2_tda_kde_5.50.5_n1_nb_cf0 
htru2_tda_kde_5.50.5_n1_nb_cf0$overall
htru2_tda_kde_5.50.5_n1_nb_cf0_ov_acc<-htru2_tda_kde_5.50.5_n1_nb_cf0$overall[1]
htru2_tda_kde_5.50.5_n1_nb_cf0$byClas1
htru2_tda_kde_5.50.5_n1_nb_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n1_nb_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_nb_n1_3_fold<-(htru2_nb_fit_re - htru2_tda_kde_5.50.5_n1_nb_fit_re)
diff_htru2_tda_kde_5.50.5_nb_n1_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nb.n1_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n1_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nb.n1_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nb.n1_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_nb.n1_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_nb.n1_3_fold$probRight
bst_htru2_tda_kde_5.50.5_nb.n1_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nb.n1_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n1_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nb.n1_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nb.n1_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n1_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nb.n1_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_nb_n1_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nb.n1_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nb_n1_3_fold))
#bf_htru2_tda_kde_5.50.5_nb.n1_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n1_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_nb.n1_test<-(htru2_nb_cf_ov_acc - htru2_tda_kde_5.50.5_n1_nb_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_nb.n1_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nb.n1_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n1_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nb.n1_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nb.n1_test_odds.left<-bst_htru2_tda_kde_5.50.5_nb.n1_test$probLeft/bst_htru2_tda_kde_5.50.5_nb.n1_test$probRight
bst_htru2_tda_kde_5.50.5_nb.n1_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nb.n1_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n1_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nb.n1_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nb.n1_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n1_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nb.n1_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_nb.n1_test)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nb.n1_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nb.n1_test)) #bf_htru2_tda_pca_5.50.5_nb.n1_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n1_test))

##Node2

htru2_TDA_KDE_5.50.5_n2_NbFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n2.vec, 
                method = 'nb', 
                trControl = fitControl,
                metric='Accuracy')

htru2_TDA_KDE_5.50.5_n2_NbFit0
htru2_TDA_KDE_5.50.5_n2_NbFit0$resample
htru2_tda_kde_5.50.5_n2_nb_fit_re<-htru2_TDA_KDE_5.50.5_n2_NbFit0$resample[1]

summary(htru2_TDA_KDE_5.50.5_n2_NbFit0)

# Predict outcome using htru2_TDA_KDE_5.50.5_n2_NbFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n2_NbFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n2_nb_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n2_nb_cf0
htru2_tda_kde_5.50.5_n2_nb_cf0 
htru2_tda_kde_5.50.5_n2_nb_cf0$overall
htru2_tda_kde_5.50.5_n2_nb_cf0_ov_acc<-htru2_tda_kde_5.50.5_n2_nb_cf0$overall[1]
htru2_tda_kde_5.50.5_n2_nb_cf0$byClass
htru2_tda_kde_5.50.5_n2_nb_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n2_nb_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_nb_n2_3_fold<-(htru2_nb_fit_re - htru2_tda_kde_5.50.5_n2_nb_fit_re)
diff_htru2_tda_kde_5.50.5_nb_n2_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nb.n2_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n2_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nb.n2_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nb.n2_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_nb.n2_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_nb.n2_3_fold$probRight
bst_htru2_tda_kde_5.50.5_nb.n2_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nb.n2_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n2_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nb.n2_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nb.n2_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n2_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nb.n2_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_nb_n2_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nb.n2_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nb_n2_3_fold))
#bf_htru2_tda_kde_5.50.5_nb.n2_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n2_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_nb.n2_test<-(htru2_nb_cf_ov_acc - htru2_tda_kde_5.50.5_n2_nb_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_nb.n2_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nb.n2_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n2_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nb.n2_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nb.n2_test_odds.left<-bst_htru2_tda_kde_5.50.5_nb.n2_test$probLeft/bst_htru2_tda_kde_5.50.5_nb.n2_test$probRight
bst_htru2_tda_kde_5.50.5_nb.n2_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nb.n2_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n2_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nb.n2_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nb.n2_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n2_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nb.n2_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_nb.n2_test)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nb.n2_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nb.n2_test)) #bf_htru2_tda_kde_5.50.5_nb.n2_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n2_test))

##Node3

htru2_TDA_KDE_5.50.5_n3_NbFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n3.vec, 
                method = 'nb', 
                trControl = fitControl,
                metric='Accuracy')

htru2_TDA_KDE_5.50.5_n3_NbFit0
htru2_TDA_KDE_5.50.5_n3_NbFit0$resample
htru2_tda_kde_5.50.5_n3_nb_fit_re<-htru2_TDA_KDE_5.50.5_n3_NbFit0$resample[1]

summary(htru2_TDA_KDE_5.50.5_n3_NbFit0)

# Predict outcome using htru2_TDA_KDE_5.50.5_n3_NbFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n3_NbFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n3_nb_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n3_nb_cf0
htru2_tda_kde_5.50.5_n3_nb_cf0 
htru2_tda_kde_5.50.5_n3_nb_cf0$overall
htru2_tda_kde_5.50.5_n3_nb_cf0_ov_acc<-htru2_tda_kde_5.50.5_n3_nb_cf0$overall[1]
htru2_tda_kde_5.50.5_n3_nb_cf0$byClass
htru2_tda_kde_5.50.5_n3_nb_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n3_nb_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_nb_n3_3_fold<-(htru2_nb_fit_re - htru2_tda_kde_5.50.5_n3_nb_fit_re)
diff_htru2_tda_kde_5.50.5_nb_n3_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nb.n3_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n3_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nb.n3_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nb.n3_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_nb.n3_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_nb.n3_3_fold$probRight
bst_htru2_tda_kde_5.50.5_nb.n3_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nb.n3_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n3_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nb.n3_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nb.n3_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n3_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nb.n3_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_nb_n3_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nb.n3_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nb_n3_3_fold))
#bf_htru2_tda_kde_5.50.5_nb.n3_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n3_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_nb.n3_test<-(htru2_nb_cf_ov_acc - htru2_tda_kde_5.50.5_n3_nb_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_nb.n3_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nb.n3_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n3_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nb.n3_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nb.n3_test_odds.left<-bst_htru2_tda_kde_5.50.5_nb.n3_test$probLeft/bst_htru2_tda_kde_5.50.5_nb.n3_test$probRight
bst_htru2_tda_kde_5.50.5_nb.n3_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nb.n3_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n3_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nb.n3_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nb.n3_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n3_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nb.n3_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_nb.n3_test)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nb.n3_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nb.n3_test)) #bf_htru2_tda_kde_5.50.5_nb.n3_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n3_test))


##Node4

htru2_TDA_KDE_5.50.5_n4_NbFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n4.vec, 
                method = 'nb', 
                trControl = fitControl,
                metric='Accuracy')

htru2_TDA_KDE_5.50.5_n4_NbFit0
htru2_TDA_KDE_5.50.5_n4_NbFit0$resample
htru2_tda_kde_5.50.5_n4_nb_fit_re<-htru2_TDA_KDE_5.50.5_n4_NbFit0$resample[1]

summary(htru2_TDA_KDE_5.50.5_n4_NbFit0)

# Predict outcome using htru2_TDA_KDE_5.50.5_n4_NbFit0 from training data based on testing data
pred0 <- predict(htru2_TDA_KDE_5.50.5_n4_NbFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
htru2_tda_kde_5.50.5_n4_nb_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
htru2_tda_kde_5.50.5_n4_nb_cf0
htru2_tda_kde_5.50.5_n4_nb_cf0 
htru2_tda_kde_5.50.5_n4_nb_cf0$overall
htru2_tda_kde_5.50.5_n4_nb_cf0_ov_acc<-htru2_tda_kde_5.50.5_n4_nb_cf0$overall[1]
htru2_tda_kde_5.50.5_n4_nb_cf0$byClass
htru2_tda_kde_5.50.5_n4_nb_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n4_nb_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

diff_htru2_tda_kde_5.50.5_nb_n4_3_fold<-(htru2_nb_fit_re - htru2_tda_kde_5.50.5_n4_nb_fit_re)
diff_htru2_tda_kde_5.50.5_nb_n4_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nb.n4_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n4_3_fold),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nb.n4_3_fold

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nb.n4_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_nb.n4_3_fold$probLeft/bst_htru2_tda_kde_5.50.5_nb.n4_3_fold$probRight
bst_htru2_tda_kde_5.50.5_nb.n4_3_fold_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nb.n4_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n4_3_fold),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nb.n4_3_fold

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nb.n4_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n4_3_fold),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nb.n4_3_fold

# Rope Plot
plot(rope(diff_htru2_tda_kde_5.50.5_nb_n4_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nb.n4_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nb_n4_3_fold))
#bf_htru2_tda_kde_5.50.5_nb.n4_3_fold

#t_test
t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n4_3_fold))


### Test set diff
diff_htru2_tda_kde_5.50.5_nb.n4_test<-(htru2_nb_cf_ov_acc - htru2_tda_kde_5.50.5_n4_nb_cf0_ov_acc)
diff_htru2_tda_kde_5.50.5_nb.n4_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

bst_htru2_tda_kde_5.50.5_nb.n4_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n4_test),-0.01,0.01)
bst_htru2_tda_kde_5.50.5_nb.n4_test

# Odds Left Bayesian Sign Test 

bst_htru2_tda_kde_5.50.5_nb.n4_test_odds.left<-bst_htru2_tda_kde_5.50.5_nb.n4_test$probLeft/bst_htru2_tda_kde_5.50.5_nb.n4_test$probRight
bst_htru2_tda_kde_5.50.5_nb.n4_test_odds.left

# Bayesian Signed Rank Test

bsr_htru2_tda_kde_5.50.5_nb.n4_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n4_test),-0.01,0.01)
bsr_htru2_tda_kde_5.50.5_nb.n4_test

# Bayesian Correlated Test

bct_htru2_tda_kde_5.50.5_nb.n4_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n4_test),0.1,-0.01,0.01)
bct_htru2_tda_kde_5.50.5_nb.n4_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_nb.n4_test)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nb.n4_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nb.n4_test)) #bf_htru2_tda_kde_5.50.5_nb.n4_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n4_test))

##Node5

#htru2_TDA_KDE_5.50.5_n5_NbFit0 <- train(as.factor(V9) ~ ., data = tda.m_HTRU_2_5.50.5.n5.vec, 
#                method = 'nb', 
#                trControl = fitControl,
#                metric='Accuracy')

#htru2_TDA_KDE_5.50.5_n5_NbFit0
#htru2_TDA_KDE_5.50.5_n5_NbFit0$resample
#htru2_tda_kde_5.50.5_n5_nb_fit_re<-htru2_TDA_KDE_5.50.5_n5_NbFit0$resample[1]

#summary(htru2_TDA_KDE_5.50.5_n5_NbFit0)

## Predict outcome using htru2_TDA_KDE_5.50.5_n5_NbFit0 from training data based on testing data
#pred0 <- predict(htru2_TDA_KDE_5.50.5_n5_NbFit0, newdata= HTRU_2Test)

# Create confusion matrix to assess model fit/performance on test data
#htru2_tda_kde_5.50.5_n5_nb_cf0<-confusionMatrix(data=pred0, as.factor(HTRU_2Test$V9))
#htru2_tda_kde_5.50.5_n5_nb_cf0
##htru2_tda_kde_5.50.5_n5_nb_cf0 
#htru2_tda_kde_5.50.5_n5_nb_cf0$overall
#htru2_tda_kde_5.50.5_n5_nb_cf0_ov_acc<-htru2_tda_kde_5.50.5_n5_nb_cf0$overall[1]
#htru2_tda_kde_5.50.5_n5_nb_cf0$byClass
#htru2_tda_kde_5.50.5_n5_nb_cf0_pre_rec_f1<-htru2_tda_kde_5.50.5_n5_nb_cf0$byClass[5:7]

###### Conduct initial Bayesian tests of non-tda-assisted RF vs. tda-assisted RF classifiers

### 3-fold diff

#diff_htru2_tda_kde_5.50.5_nb_n5_3_fold<-(htru2_nb_fit_re - htru2_tda_kde_5.50.5_n5_nb_fit_re)
#diff_htru2_tda_kde_5.50.5_nb_n5_3_fold

## Bayesian Tests 3-fold diff

# Bayesian Sign Test

#bst_htru2_tda_kde_5.50.5_nb.n5_3_fold<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n5_3_fol#d),-0.01,0.01)
#bst_htru2_tda_kde_5.50.5_nb.n5_3_fold

# Odds Left Bayesian Sign Test 

#bst_htru2_tda_kde_5.50.5_nb.n5_3_fold_odds.left<-bst_htru2_tda_kde_5.50.5_nb.n5_3_fold$probLeft/bst_htr#u2_tda_kde_5.50.5_nb.n5_3_fold$probRight
#bst_htru2_tda_kde_5.50.5_nb.n5_3_fold_odds.left

# Bayesian Signed Rank Test

#bsr_htru2_tda_kde_5.50.5_nb.n5_3_fold<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n5_3_f#old),-0.01,0.01)
#bsr_htru2_tda_kde_5.50.5_nb.n5_3_fold

# Bayesian Correlated Test

#bct_htru2_tda_kde_5.50.5_nb.n5_3_fold<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n#5_3_fold),0.1,-0.01,0.01)
#bct_htru2_tda_kde_5.50.5_nb.n5_3_fold

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_nb_n5_3_fold,c(-0.01,0.01)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nb.n5_3_fold = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nb_n5_3_fold))
#bf_htru2_tda_kde_5.50.5_nb.n5_3_fold

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nb_n5_3_fold))


### Test set diff
#diff_htru2_tda_kde_5.50.5_nb.n5_test<-(htru2_nb_cf_ov_acc - htru2_tda_kde_5.50.5_n5_nb_cf0_ov_acc)
#diff_htru2_tda_kde_5.50.5_nb.n5_test


## Bayesian Tests Test set diff

# Bayesian Sign Test

#bst_htru2_tda_kde_5.50.5_nb.n5_test<-BayesianSignTest(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n5_test),-#0.01,0.01)
#bst_htru2_tda_kde_5.50.5_nb.n5_test

# Odds Left Bayesian Sign Test 

#bst_htru2_tda_kde_5.50.5_nb.n5_test_odds.left<-bst_htru2_tda_kde_5.50.5_nb.n5_test$probLeft/bst_htru2_t#da_kde_5.50.5_nb.n5_test$probRight
#bst_htru2_tda_kde_5.50.5_nb.n5_test_odds.left

# Bayesian Signed Rank Test

#bsr_htru2_tda_kde_5.50.5_nb.n5_test<-BayesianSignedRank(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n5_test)#,-0.01,0.01)
#bsr_htru2_tda_kde_5.50.5_nb.n5_test

# Bayesian Correlated Test

#bct_htru2_tda_kde_5.50.5_nb.n5_test<-correlatedBayesianTtest(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n5_#test),0.1,-0.01,0.01)
#bct_htru2_tda_kde_5.50.5_nb.n5_test

# Rope Plot
#plot(rope(diff_htru2_tda_kde_5.50.5_nb.n5_test)))

#BayesFactor
#bf_htru2_tda_kde_5.50.5_nb.n5_test = ttestBF(x = as.matrix(diff_htru2_tda_kde_5.50.5_nb.n5_test)) #bf_htru2_tda_kde_5.50.5_nb.n5_test

#t_test
#t.test(as.matrix(diff_htru2_tda_kde_5.50.5_nb.n5_test)) 

```  
  
